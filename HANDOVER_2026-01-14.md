# 작업 인수인계 문서 (2026-01-14)

> 다음 작업자를 위한 오늘 작업 내역 및 프로젝트 현황 정리

---

## 1. 오늘 완료된 커밋

### 커밋 1: `520f913` (13시간 전)
**Fix: UI overlap, nickname clipping, and table layout optimization**
- 테이블 UI 오버랩 문제 수정
- 닉네임 잘림 현상 해결
- 테이블 레이아웃 최적화

### 커밋 2: `5836bac` (23시간 전)
**feat: 메모리 기반 게임 엔진 구현 및 프론트엔드 완성**
- 메모리 기반 PokerTable 엔진 완성
- WebSocket 이벤트 핸들러 구현
- 프론트엔드 게임 테이블 페이지 완성

---

## 2. 현재 미커밋 작업 (진행 중)

### 변경된 파일 (총 12개, +3,024줄 / -548줄)

| 파일 | 변경 내용 |
|------|----------|
| `backend/app/api/rooms.py` | +65줄 - 방 API 확장 |
| `backend/app/game/poker_table.py` | +30줄 - 게임 로직 개선 |
| `backend/app/ws/events.py` | +12줄 - 이벤트 타입 추가 |
| `backend/app/ws/handlers/action.py` | +286줄 - 액션 핸들러 대폭 확장 |
| `backend/app/ws/handlers/table.py` | +171줄 - 테이블 핸들러 확장 |
| `frontend/src/app/table/[id]/page.tsx` | **+2,468줄 → 총 3,563줄** - 대규모 UI 개선 |
| `frontend/src/app/globals.css` | +455줄 - 스타일 추가 |
| `frontend/src/app/lobby/page.tsx` | +38줄 - 로비 UI 개선 |
| `frontend/src/app/layout.tsx` | +15줄 - 레이아웃 수정 |
| `frontend/src/components/lobby/HoldemCard.tsx` | +32줄 - 카드 컴포넌트 개선 |

### 새로 추가된 파일/폴더

```
backend/app/game/hand_evaluator.py     # 봇용 핸드 강도 평가기
frontend/public/assets/cards/          # 카드 스프라이트 이미지
  └── Cards.png                        # 56x80 카드 이미지 (14열 x 6행)
frontend/public/assets/ui/             # UI 에셋
  ├── btn_allin.png
  ├── btn_call.png
  ├── btn_check.png
  ├── btn_fold.png
  └── btn_raise.png
frontend/public/assets/example/        # 예제 이미지
frontend/public/fonts/                 # 폰트 파일
frontend/src/app/chip-test/            # 칩 테스트 페이지 (개발용)
```

---

## 3. 프로젝트 현재 상태

### 작동하는 기능
- 회원가입/로그인 (JWT 인증)
- 로비에서 테이블 목록 조회
- 테이블 생성 및 참여 (바이인)
- 실시간 포커 게임 플레이 (9인 테이블)
  - 프리플랍 → 플랍 → 턴 → 리버 → 쇼다운
  - 폴드/체크/콜/레이즈/올인 액션
  - 봇 플레이어 자동 진행
- 쇼다운 결과 표시 (족보, 승자)
- 자동 다음 핸드 진행

### 게임 엔진 구조

```
메모리 기반 게임 (현재 사용)
├── game/manager.py      # GameManager 싱글톤
├── game/poker_table.py  # PokerTable 클래스 (핵심)
└── game/hand_evaluator.py # 핸드 강도 평가 (NEW)

WebSocket 핸들러
├── ws/handlers/table.py  # 테이블 구독/좌석
└── ws/handlers/action.py # 게임 액션 처리 (핵심)
```

---

## 4. 핵심 파일 위치

### 백엔드

| 파일 | 역할 |
|------|------|
| `backend/app/game/poker_table.py` | 게임 로직 핵심 (PokerKit 래핑) |
| `backend/app/game/manager.py` | 테이블 생성/관리 싱글톤 |
| `backend/app/ws/handlers/action.py` | 액션 처리 (fold/call/raise) |
| `backend/app/ws/handlers/table.py` | 테이블 구독, 좌석 관리 |
| `backend/app/ws/events.py` | WebSocket 이벤트 타입 정의 |

### 프론트엔드

| 파일 | 역할 |
|------|------|
| `frontend/src/app/table/[id]/page.tsx` | **게임 테이블 UI (핵심, 3,563줄)** |
| `frontend/src/lib/websocket.ts` | WebSocket 클라이언트 |
| `frontend/src/lib/handEvaluator.ts` | 족보 계산 (클라이언트) |
| `frontend/src/app/globals.css` | 전역 스타일 |

---

## 5. 실행 방법

### Docker로 전체 실행 (권장)

```bash
docker-compose -f infra/docker/docker-compose.full.yml up -d
```

### 로컬 개발

```bash
# DB만 Docker로
docker-compose -f infra/docker/docker-compose.dev.yml up -d

# 백엔드
cd backend
source .venv/bin/activate
uvicorn app.main:app --reload

# 프론트엔드
cd frontend
npm run dev
```

### 접속 URL

| 서비스 | URL |
|--------|-----|
| 프론트엔드 | http://localhost:3000 |
| 백엔드 API 문서 | http://localhost:8000/docs |
| WebSocket | ws://localhost:8000/ws?token=TOKEN |

---

## 6. 다음 작업자 참고사항

### 주의점

1. **테이블 페이지가 3,563줄로 매우 큼** - 리팩토링 고려 필요
2. **미커밋 변경사항이 많음** - 커밋 전 테스트 필수
3. **카드 스프라이트**: `Cards.png` (784x480, 카드 56x80)
   - 행: 슈트 (하트=0, 스페이드=1, 다이아=2, 클럽=3)
   - 열: 랭크 (뒷면=0, A=1, 2-10, J=11, Q=12, K=13)

### WebSocket 메시지 흐름

```
SUBSCRIBE_TABLE → TABLE_SNAPSHOT
START_GAME → HAND_STARTED (홀카드)
TURN_PROMPT (내 턴) → ACTION_REQUEST → ACTION_RESULT
... 반복 ...
HAND_RESULT (쇼다운)
```

---

## 7. 남은 TODO

### 즉시 필요
- [ ] 미커밋 변경사항 테스트 후 커밋
- [ ] 테이블 페이지 컴포넌트 분리

### 기능 개발
- [ ] 토너먼트 기능
- [ ] 지갑 입출금 연동
- [ ] 핸드 히스토리 조회
- [ ] 사운드 효과

---

## 관련 문서

- [PROJECT_DOCUMENTATION.md](PROJECT_DOCUMENTATION.md) - 프로젝트 전체 문서
- [QUICKSTART.md](QUICKSTART.md) - 퀵스타트 가이드
- [CLAUDE.md](CLAUDE.md) - Claude Code 작업 지침

---

*작성일: 2026-01-14*
