# 백엔드/관리자 업그레이드 작업 계획서

**작성일**: 2026-01-16
**기준 문서**: IMPLEMENTATION_STATUS.md, CODE_REVIEW_REPORT.md
**총 작업 단계**: 25단계 (Phase 1~5)

---

## 작업 지침

### 작업 규칙
1. **한 세션에 한 단계만 작업** - 토큰 한계로 인해 한 단계 완료 후 종료
2. **작업 완료 시 반드시 검증 테스트 실행** - 테스트 통과 확인 후 완료 처리
3. **전문 서브에이전트 사용** - 각 작업에 맞는 에이전트 활용
4. **완료 체크 필수** - 각 단계 완료 시 `[ ]` → `[x]`로 변경
5. **작업 중단 시 현재 단계 기록** - 다음 세션에서 이어서 작업

### 작업 순서
```
┌─────────────────────────────────────────────────────────┐
│  Phase 1: 보안 (5단계)            ◀── 🔴 최우선        │
│  Phase 2: 부정 방지 연동 (5단계)   ◀── 🟠 우선         │
│  Phase 3: 관리자 기능 (7단계)      ◀── 🟡 일반         │
│  Phase 4: 안정성 개선 (5단계)      ◀── 🟢 낮음         │
│  Phase 5: 운영 도구 (3단계)        ◀── 🔵 선택         │
└─────────────────────────────────────────────────────────┘
```

### 사용할 서브에이전트
| 에이전트 | 용도 |
|----------|------|
| `context-gatherer` | 코드 분석, 관련 파일 파악 |
| `general-task-execution` | 멀티 파일 작업, 복잡한 구현 |
| `Bash` | 테스트 실행, 검증 |


### 진행 상황 요약
| 구분 | 완료 | 전체 | 진행률 |
|------|------|------|--------|
| **Phase 1 (보안)** | 4 | 5 | 80% |
| **Phase 2 (부정 방지)** | 0 | 5 | 0% |
| **Phase 3 (관리자)** | 0 | 7 | 0% |
| **Phase 4 (안정성)** | 0 | 5 | 0% |
| **Phase 5 (운영)** | 0 | 3 | 0% |
| **전체** | **4** | **25** | **16%** |

- **현재 단계**: Phase 1 완료 (1.1 보류), Phase 2.1 대기
- **마지막 업데이트**: 2026-01-16

---

# Phase 1: 보안 강화 (🔴 최우선)

## 1.1 로그인 시 2FA 검증 로직 추가
**우선순위**: 🔴 P0 (최고)
**예상 시간**: 45분
**파일**: `backend/app/api/auth.py`, `backend/app/schemas/__init__.py`

### 현재 상태
- 2FA 설정/활성화/비활성화 API 구현 완료
- **문제**: 로그인 시 2FA 코드 검증 없음 (비밀번호만 확인하면 토큰 발급)

### 작업 내용
- [ ] **1.1.1** `LoginRequest` 스키마에 `totp_code` 필드 추가 (Optional)
- [ ] **1.1.2** `auth.py` login 엔드포인트에서 2FA 활성화 여부 확인
- [ ] **1.1.3** 2FA 활성화된 경우 TOTP 코드 필수 검증 로직 추가
- [ ] **1.1.4** 2FA 필요 시 `2FA_REQUIRED` 에러 응답 추가
- [ ] **1.1.5** 테스트 실행: `cd backend && pytest tests/api/ -v -k auth`
- [ ] **1.1.6** 수정 검증 완료

### 수정 예시
```python
# LoginRequest에 추가
totp_code: str | None = Field(None, min_length=6, max_length=6)

# login 엔드포인트에서
if user_has_2fa_enabled:
    if not request_body.totp_code:
        raise HTTPException(status_code=403, detail={"code": "2FA_REQUIRED"})
    if not verify_totp(user.two_factor.secret, request_body.totp_code):
        raise HTTPException(status_code=401, detail={"code": "INVALID_2FA_CODE"})
```

### 완료 확인
- [ ] **단계 1.1 완료** (날짜: ______, 검증: ____ tests passed)

---

## 1.2 로그인 시도 제한 (Rate Limiting 강화)
**우선순위**: 🔴 P0
**예상 시간**: 30분
**파일**: `backend/app/api/auth.py`, `backend/app/services/login_limiter.py`

### 현재 상태
- 기본 Rate Limiting 미들웨어 존재
- ✅ **완료**: Redis 기반 로그인 실패 카운터 구현

### 작업 내용
- [x] **1.2.1** Redis 기반 로그인 실패 카운터 구현 (`login_limiter.py`)
- [x] **1.2.2** 5회 실패 시 15분 잠금 로직 추가
- [x] **1.2.3** 잠금 상태 확인 및 에러 응답 추가 (429 + Retry-After 헤더)
- [x] **1.2.4** 성공 시 카운터 리셋
- [x] **1.2.5** 테스트 실행: 36 tests passed
- [x] **1.2.6** 수정 검증 완료

### 완료 확인
- [x] **단계 1.2 완료** (날짜: 2026-01-16, 검증: 36 tests passed)

---

## 1.3 JWT 토큰 만료 검증 강화
**우선순위**: 🔴 P0
**예상 시간**: 30분
**파일**: `backend/app/api/deps.py`, `backend/app/services/auth.py`

### 현재 상태
- JWT 토큰 발급 구현됨
- ✅ **완료**: 토큰 만료 명시적 검증, 동시 세션 제한 구현

### 작업 내용
- [x] **1.3.1** JWT 디코딩 시 만료 시간 명시적 검증 추가 (`TokenError` 예외 클래스)
- [x] **1.3.2** 동시 세션 제한 (최대 3개) 구현 (`MAX_SESSIONS_PER_USER`)
- [x] **1.3.3** 새 로그인 시 가장 오래된 세션 자동 만료 (`_enforce_session_limit`)
- [x] **1.3.4** 테스트 실행: 197 tests passed (services), 35 tests passed (api auth)
- [x] **1.3.5** 수정 검증 완료

### 완료 확인
- [x] **단계 1.3 완료** (날짜: 2026-01-16, 검증: 197 tests passed)

---

## 1.4 민감 정보 로깅 마스킹
**우선순위**: 🟠 P1
**예상 시간**: 20분
**파일**: `backend/app/logging_config.py`

### 현재 상태
- 구조화된 로깅 구현됨
- ✅ **완료**: 민감 정보 마스킹 필터 구현

### 작업 내용
- [x] **1.4.1** 로그 필터 클래스 생성 (이메일, 카드번호, IP, JWT 토큰 마스킹)
- [x] **1.4.2** 기존 로거에 필터 적용 (`sensitive_data_filter` 프로세서)
- [x] **1.4.3** 테스트 실행: 65 tests passed (utils)
- [x] **1.4.4** 수정 검증 완료

### 마스킹 대상
- **완전 마스킹**: password, token, api_key, secret, totp_code 등
- **부분 마스킹**: email (u***@domain.com), IP (192.168.xxx.xxx), user_agent (50자 제한)
- **패턴 마스킹**: JWT 토큰, 카드번호, JSON 내 password/secret 필드

### 완료 확인
- [x] **단계 1.4 완료** (날짜: 2026-01-16, 검증: 65 tests passed)

---

## 1.5 WebSocket 인증 토큰 검증 강화
**우선순위**: 🟠 P1
**예상 시간**: 30분
**파일**: `backend/app/ws/gateway.py`

### 현재 상태
- WebSocket 연결 시 토큰 검증 존재
- ✅ **완료**: 주기적 토큰 검증 및 만료 시 자동 종료 구현

### 작업 내용
- [x] **1.5.1** 주기적 토큰 유효성 검사 (5분마다) - `TokenValidator` 클래스
- [x] **1.5.2** 만료된 토큰 연결 자동 종료 (close code 4002)
- [x] **1.5.3** 클라이언트에 재인증 요청 이벤트 전송 (`REAUTH_REQUIRED`)
- [x] **1.5.4** 테스트 실행: 105 tests passed (ws)
- [x] **1.5.5** 수정 검증 완료

### 구현 세부사항
- `TokenValidator`: 비동기 토큰 검증 루프
- `TOKEN_VALIDATION_INTERVAL_SECONDS = 300` (5분)
- `REAUTH_REQUIRED` 메시지로 클라이언트에 재인증 요청
- 연결 종료 시 `token_validator.stop()` 호출로 리소스 정리

### 완료 확인
- [x] **단계 1.5 완료** (날짜: 2026-01-16, 검증: 105 tests passed)

---

# Phase 2: 부정 방지 시스템 연동 (🟠 우선)

## 2.1 칩 밀어주기 탐지 게임 서버 연동
**우선순위**: 🟠 P1
**예상 시간**: 60분
**파일**: `backend/app/ws/handlers/action.py`, `admin-backend/app/services/chip_dumping_detector.py`

### 현재 상태
- `admin-backend`에 ChipDumpingDetector 구현 완료 (11개 테스트 통과)
- ✅ **완료**: 게임 서버 연동 구현됨 (FraudEventPublisher + FraudEventConsumer)

### 작업 내용
- [x] **2.1.1** 게임 서버에서 핸드 완료 시 이벤트 발행 구조 설계 (`fraud_event_publisher.py`)
- [x] **2.1.2** Redis pub/sub으로 핸드 결과 전송 (`fraud:hand_completed` 채널)
- [x] **2.1.3** admin-backend에서 핸드 결과 수신 및 분석 (`fraud_event_consumer.py`)
- [x] **2.1.4** 의심 패턴 발견 시 알림 발송 (`_flag_suspicious_activity()`)
- [x] **2.1.5** 테스트 실행: 11 passed (chip_dumping), 27 passed (fraud_event_consumer)
- [x] **2.1.6** 수정 검증 완료

### 완료 확인
- [x] **단계 2.1 완료** (날짜: 2026-01-20, 검증: 38 tests passed)

---

## 2.2 봇 탐지 시스템 게임 서버 연동
**우선순위**: 🟠 P1
**예상 시간**: 45분
**파일**: `backend/app/ws/handlers/action.py`, `admin-backend/app/services/bot_detector.py`

### 현재 상태
- `admin-backend`에 BotDetector 구현 완료
- ✅ **완료**: 실시간 분석 연동 (`fraud:player_action` 채널)

### 작업 내용
- [x] **2.2.1** 플레이어 액션 타이밍 데이터 수집 (`FraudEventPublisher.publish_player_action()`)
- [x] **2.2.2** 액션 패턴 데이터 Redis 저장 (`_action_buffer`)
- [x] **2.2.3** admin-backend에서 패턴 분석 (`_analyze_bot_behavior()`)
- [x] **2.2.4** 봇 의심 시 자동 플래그 처리 (`run_realtime_bot_detection()`)
- [x] **2.2.5** 테스트 실행: fraud_event_consumer 27 passed
- [x] **2.2.6** 수정 검증 완료

### 완료 확인
- [x] **단계 2.2 완료** (날짜: 2026-01-20, 검증: 27 tests passed)

---

## 2.3 이상 행동 탐지 연동
**우선순위**: 🟠 P1
**예상 시간**: 45분
**파일**: `admin-backend/app/services/anomaly_detector.py`

### 현재 상태
- AnomalyDetector 구현 완료
- ✅ **완료**: 실시간 분석 연동 (`fraud:player_stats` 채널)

### 작업 내용
- [x] **2.3.1** 게임 서버에서 플레이어 통계 주기적 전송 (`publish_player_stats()`)
- [x] **2.3.2** 이상 패턴 실시간 분석 (`handle_player_stats()`, `_run_anomaly_detection()`)
- [x] **2.3.3** 알림 시스템 연동 (`_flag_suspicious_activity()`)
- [x] **2.3.4** 테스트 실행: fraud_event_consumer 27 passed
- [x] **2.3.5** 수정 검증 완료

### 완료 확인
- [x] **단계 2.3 완료** (날짜: 2026-01-20, 검증: 27 tests passed)

---

## 2.4 자동 밴 시스템 연동
**우선순위**: 🟠 P1
**예상 시간**: 30분
**파일**: `admin-backend/app/services/auto_ban.py`

### 현재 상태
- AutoBan 서비스 구현 완료
- ✅ **완료**: 탐지 시스템과 자동 연동 (`process_detection()`)

### 작업 내용
- [x] **2.4.1** 탐지 결과 → 자동 밴 트리거 연결 (`AutoBanService.process_detection()`)
- [x] **2.4.2** 밴 임계값 설정 (severity 기반 자동 판단)
- [x] **2.4.3** 관리자 알림 연동 (`TelegramNotifier.notify_admins()`)
- [x] **2.4.4** 테스트 실행: auto_ban 19 passed, fraud_event_consumer 27 passed
- [x] **2.4.5** 수정 검증 완료

### 완료 확인
- [x] **단계 2.4 완료** (날짜: 2026-01-20, 검증: 46 tests passed)

---

## 2.5 핸드 히스토리 DB 저장
**우선순위**: 🟠 P1
**예상 시간**: 60분
**파일**: `backend/app/services/hand_history.py`, `backend/app/models/hand.py`, `backend/app/api/hands.py`

### 현재 상태
- ✅ **완료**: 핸드 히스토리 PostgreSQL 저장 + API 구현됨

### 작업 내용
- [x] **2.5.1** HandHistory 모델 생성 (`Hand`, `HandEvent`, `HandParticipant` - JSONB 지원)
- [x] **2.5.2** 핸드 완료 시 DB 저장 로직 (`action.py` line 1502-1517)
- [x] **2.5.3** 핸드 조회 API (`/hands/me`, `/hands/{id}`, `/hands/{id}/replay`)
- [x] **2.5.4** Alembic 마이그레이션 (`add_hand_participants.py`)
- [x] **2.5.5** 테스트 실행: 15 passed (test_hand_history.py)
- [x] **2.5.6** 수정 검증 완료

### 완료 확인
- [x] **단계 2.5 완료** (날짜: 2026-01-20, 검증: 15 tests passed)

---

# Phase 3: 관리자 기능 (🟡 일반)

## 3.1 서버 점검 모드 제어
**우선순위**: 🟡 P2
**예상 시간**: 45분
**파일**: `admin-backend/app/api/system.py` (신규)

### 작업 내용
- [ ] **3.1.1** 점검 모드 상태 저장 (Redis)
- [ ] **3.1.2** 점검 모드 ON/OFF API 추가
- [ ] **3.1.3** 게임 서버에서 점검 모드 확인 미들웨어
- [ ] **3.1.4** 점검 중 신규 입장 차단
- [ ] **3.1.5** 테스트 실행
- [ ] **3.1.6** 수정 검증 완료

### 완료 확인
- [ ] **단계 3.1 완료** (날짜: ______, 검증: ____ tests passed)

---

## 3.2 공지사항 발송 시스템
**우선순위**: 🟡 P2
**예상 시간**: 45분
**파일**: `admin-backend/app/api/announcements.py` (신규)

### 작업 내용
- [ ] **3.2.1** Announcement 모델 생성
- [ ] **3.2.2** 공지 CRUD API 추가
- [ ] **3.2.3** WebSocket으로 실시간 공지 브로드캐스트
- [ ] **3.2.4** 프론트엔드 공지 표시 컴포넌트
- [ ] **3.2.5** 테스트 실행
- [ ] **3.2.6** 수정 검증 완료

### 완료 확인
- [ ] **단계 3.2 완료** (날짜: ______, 검증: ____ tests passed)

---

## 3.3 방 강제 종료 기능
**우선순위**: 🟡 P2
**예상 시간**: 30분
**파일**: `admin-backend/app/api/rooms.py`

### 작업 내용
- [ ] **3.3.1** 방 강제 종료 API 추가
- [ ] **3.3.2** 진행 중인 핸드 강제 종료 로직
- [ ] **3.3.3** 플레이어 칩 환불 처리
- [ ] **3.3.4** 테스트 실행
- [ ] **3.3.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 3.3 완료** (날짜: ______, 검증: ____ tests passed)

---

## 3.4 핸드 리플레이 기능
**우선순위**: 🟡 P2
**예상 시간**: 60분
**파일**: `admin-backend/app/api/hands.py`

### 작업 내용
- [ ] **3.4.1** 핸드 상세 조회 API 추가
- [ ] **3.4.2** 액션별 타임라인 데이터 구조화
- [ ] **3.4.3** 관리자 프론트엔드 리플레이 뷰어
- [ ] **3.4.4** 테스트 실행
- [ ] **3.4.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 3.4 완료** (날짜: ______, 검증: ____ tests passed)

---

## 3.5 자산 수동 지급/회수
**우선순위**: 🟡 P2
**예상 시간**: 45분
**파일**: `admin-backend/app/api/users.py`

### 작업 내용
- [ ] **3.5.1** 칩 지급 API 추가 (관리자 권한)
- [ ] **3.5.2** 칩 회수 API 추가 (관리자 권한)
- [ ] **3.5.3** 감사 로그 자동 기록
- [ ] **3.5.4** 트랜잭션 무결성 보장
- [ ] **3.5.5** 테스트 실행
- [ ] **3.5.6** 수정 검증 완료

### 완료 확인
- [ ] **단계 3.5 완료** (날짜: ______, 검증: ____ tests passed)

---

## 3.6 유저 상세 로그 조회
**우선순위**: 🟡 P2
**예상 시간**: 30분
**파일**: `admin-backend/app/api/users.py`

### 작업 내용
- [ ] **3.6.1** 유저 활동 로그 조회 API 추가
- [ ] **3.6.2** 로그인 기록, 게임 기록, 입출금 기록 통합
- [ ] **3.6.3** 필터링 및 페이지네이션
- [ ] **3.6.4** 테스트 실행
- [ ] **3.6.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 3.6 완료** (날짜: ______, 검증: ____ tests passed)

---

## 3.7 부정 사용자 의심 리스트
**우선순위**: 🟡 P2
**예상 시간**: 30분
**파일**: `admin-backend/app/api/suspicious.py` (신규)

### 작업 내용
- [ ] **3.7.1** 의심 사용자 리스트 API 추가
- [ ] **3.7.2** 탐지 시스템 결과 통합 뷰
- [ ] **3.7.3** 관리자 검토 상태 관리
- [ ] **3.7.4** 테스트 실행
- [ ] **3.7.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 3.7 완료** (날짜: ______, 검증: ____ tests passed)

---

# Phase 4: 안정성 개선 (🟢 낮음)

## 4.1 대기열(Waitlist) 관리
**우선순위**: 🟢 P3
**예상 시간**: 45분
**파일**: `backend/app/services/room.py`

### 작업 내용
- [ ] **4.1.1** 대기열 데이터 구조 (Redis)
- [ ] **4.1.2** 대기열 등록/취소 API
- [ ] **4.1.3** 자리 비면 자동 입장 로직
- [ ] **4.1.4** 테스트 실행
- [ ] **4.1.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 4.1 완료** (날짜: ______, 검증: ____ tests passed)

---

## 4.2 관전자/플레이어 그룹 분리 전송
**우선순위**: 🟢 P3
**예상 시간**: 30분
**파일**: `backend/app/ws/manager.py`

### 작업 내용
- [ ] **4.2.1** 채널 그룹 분리 (players, spectators)
- [ ] **4.2.2** 그룹별 메시지 전송 최적화
- [ ] **4.2.3** 테스트 실행
- [ ] **4.2.4** 수정 검증 완료

### 완료 확인
- [ ] **단계 4.2 완료** (날짜: ______, 검증: ____ tests passed)

---

## 4.3 중간 입장 동기화 (Snapshot)
**우선순위**: 🟢 P3
**예상 시간**: 45분
**파일**: `backend/app/ws/handlers/join.py`

### 작업 내용
- [ ] **4.3.1** 테이블 스냅샷 생성 로직
- [ ] **4.3.2** 중간 입장 시 스냅샷 전송
- [ ] **4.3.3** 클라이언트 상태 동기화
- [ ] **4.3.4** 테스트 실행
- [ ] **4.3.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 4.3 완료** (날짜: ______, 검증: ____ tests passed)

---

## 4.4 WebSocket 하트비트 구현
**우선순위**: 🟢 P3
**예상 시간**: 30분
**파일**: `backend/app/ws/gateway.py`

### 작업 내용
- [ ] **4.4.1** 서버 → 클라이언트 ping 전송 (30초)
- [ ] **4.4.2** 클라이언트 pong 응답 확인
- [ ] **4.4.3** 응답 없는 연결 자동 종료
- [ ] **4.4.4** 테스트 실행
- [ ] **4.4.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 4.4 완료** (날짜: ______, 검증: ____ tests passed)

---

## 4.5 메모리 정리 최적화
**우선순위**: 🟢 P3
**예상 시간**: 30분
**파일**: `backend/app/game/manager.py`

### 작업 내용
- [ ] **4.5.1** 빈 테이블 자동 정리 (30분 후)
- [ ] **4.5.2** 완료된 핸드 데이터 정리
- [ ] **4.5.3** 메모리 사용량 모니터링 로그
- [ ] **4.5.4** 테스트 실행
- [ ] **4.5.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 4.5 완료** (날짜: ______, 검증: ____ tests passed)

---

# Phase 5: 운영 도구 (🔵 선택)

## 5.1 CCU 실시간 모니터링
**우선순위**: 🔵 P4
**예상 시간**: 30분
**파일**: `admin-backend/app/api/dashboard.py`

### 작업 내용
- [ ] **5.1.1** 실시간 접속자 수 집계 (Redis)
- [ ] **5.1.2** 대시보드 API 추가
- [ ] **5.1.3** 프론트엔드 실시간 차트
- [ ] **5.1.4** 테스트 실행
- [ ] **5.1.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 5.1 완료** (날짜: ______, 검증: ____ tests passed)

---

## 5.2 DAU/MAU 통계
**우선순위**: 🔵 P4
**예상 시간**: 30분
**파일**: `admin-backend/app/services/statistics_service.py`

### 작업 내용
- [ ] **5.2.1** 일별/월별 활성 사용자 집계
- [ ] **5.2.2** 통계 API 추가
- [ ] **5.2.3** 대시보드 차트 연동
- [ ] **5.2.4** 테스트 실행
- [ ] **5.2.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 5.2 완료** (날짜: ______, 검증: ____ tests passed)

---

## 5.3 매출 현황 대시보드
**우선순위**: 🔵 P4
**예상 시간**: 30분
**파일**: `admin-backend/app/api/dashboard.py`

### 작업 내용
- [ ] **5.3.1** 레이크 수익 집계
- [ ] **5.3.2** 입금/출금 통계
- [ ] **5.3.3** 대시보드 매출 차트
- [ ] **5.3.4** 테스트 실행
- [ ] **5.3.5** 수정 검증 완료

### 완료 확인
- [ ] **단계 5.3 완료** (날짜: ______, 검증: ____ tests passed)

---

## 작업 완료 체크리스트

### Phase 1 (보안) - 5단계
- [ ] 1.1 로그인 시 2FA 검증 로직 추가 (보류)
- [x] 1.2 로그인 시도 제한
- [x] 1.3 JWT 토큰 만료 검증 강화
- [x] 1.4 민감 정보 로깅 마스킹
- [x] 1.5 WebSocket 인증 토큰 검증 강화

### Phase 2 (부정 방지) - 5단계
- [ ] 2.1 칩 밀어주기 탐지 게임 서버 연동
- [ ] 2.2 봇 탐지 시스템 게임 서버 연동
- [ ] 2.3 이상 행동 탐지 연동
- [ ] 2.4 자동 밴 시스템 연동
- [ ] 2.5 핸드 히스토리 DB 저장

### Phase 3 (관리자) - 7단계
- [ ] 3.1 서버 점검 모드 제어
- [ ] 3.2 공지사항 발송 시스템
- [ ] 3.3 방 강제 종료 기능
- [ ] 3.4 핸드 리플레이 기능
- [ ] 3.5 자산 수동 지급/회수
- [ ] 3.6 유저 상세 로그 조회
- [ ] 3.7 부정 사용자 의심 리스트

### Phase 4 (안정성) - 5단계
- [ ] 4.1 대기열(Waitlist) 관리
- [ ] 4.2 관전자/플레이어 그룹 분리 전송
- [ ] 4.3 중간 입장 동기화 (Snapshot)
- [ ] 4.4 WebSocket 하트비트 구현
- [ ] 4.5 메모리 정리 최적화

### Phase 5 (운영) - 3단계
- [ ] 5.1 CCU 실시간 모니터링
- [ ] 5.2 DAU/MAU 통계
- [ ] 5.3 매출 현황 대시보드

---

## 테스트 명령어 참조

```bash
# Backend 전체 테스트
cd backend && pytest tests/ -v

# 특정 모듈 테스트
cd backend && pytest tests/api/ -v -k auth
cd backend && pytest tests/ws/ -v
cd backend && pytest tests/services/ -v

# Admin Backend 테스트
cd admin-backend && pytest tests/ -v

# Frontend 빌드 테스트
cd admin-frontend && npm run build
cd frontend && npm run build

# 타입 체크
cd backend && mypy app/
```

---

## 세션 인계 메모

> 다음 세션에서 작업을 이어받을 때 이 섹션을 업데이트하세요.

**현재 진행 중인 단계**: Phase 2.1 대기
**마지막 완료 단계**: Phase 1.5 WebSocket 인증 토큰 검증 강화
**다음 작업**: 2.1 칩 밀어주기 탐지 게임 서버 연동
**특이사항**: 
- Phase 1 보안 강화 완료 (1.1 2FA 검증은 사용자 요청으로 보류)
- Phase 2는 부정 방지 시스템 연동 작업
- 작업 시작 전 반드시 context-gatherer로 관련 파일 파악
- 각 단계 완료 후 테스트 실행 필수
- 완료 시 체크박스 업데이트 필수

---

## 작업 로그

| 날짜 | 단계 | 상태 | 비고 |
|------|------|------|------|
| 2026-01-16 | 계획서 작성 | 완료 | 25단계 작업 계획 수립 |
| 2026-01-16 | Phase 1.2 | 완료 | 로그인 시도 제한 구현 (36 tests passed) |
| 2026-01-16 | Phase 1.3 | 완료 | JWT 토큰 만료 검증 강화 (197 tests passed) |
| 2026-01-16 | Phase 1.4 | 완료 | 민감 정보 로깅 마스킹 (65 tests passed) |
| 2026-01-16 | Phase 1.5 | 완료 | WebSocket 토큰 검증 강화 (105 tests passed) |
| - | - | - | - |

---

## 중단 대비 체크포인트

### 작업 중단 시 필수 기록 사항
1. 현재 진행 중인 단계 번호
2. 해당 단계 내 완료된 서브태스크
3. 수정한 파일 목록
4. 발생한 에러 (있는 경우)
5. 다음 작업 내용

### 재개 시 확인 사항
1. 이 문서에서 마지막 완료 단계 확인
2. 미완료 서브태스크 확인
3. 테스트 실행하여 현재 상태 검증
4. 현재 단계부터 재개

---

**작성자**: Claude Code
**버전**: 1.0
**변경이력**:
- v1.0 (2026-01-16): 초안 작성 - 25단계 작업 계획
