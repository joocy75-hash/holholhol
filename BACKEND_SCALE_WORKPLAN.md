# í™€ë¤ í¬ì»¤ ë°±ì—”ë“œ ìŠ¤ì¼€ì¼ë§ ì‘ì—…ê³„íšì„œ

> **ì‘ì„±ì¼**: 2026-01-12
> **ë²„ì „**: 1.3 Final (ì˜¤í”ˆì†ŒìŠ¤ í†µí•© ì™„ë£Œ)
> **ëª©í‘œ**: 300-500ëª… ë™ì‹œ ì ‘ì† ì•ˆì • ìš´ì˜ ê°€ëŠ¥í•œ ê³ ì„±ëŠ¥ ë°±ì—”ë“œ êµ¬ì¶•
> **ë²”ìœ„**: ë°±ì—”ë“œ 100% (í”„ë¡ íŠ¸ì—”ë“œ ì œì™¸)

---

## í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’° í™”í ì‹œìŠ¤í…œ                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ê²Œì„ ë‚´ í‘œì‹œ: KRW (ì›í™”)                                             â”‚
â”‚  â”œâ”€â”€ ëª¨ë“  ì¹©/ë² íŒ…/íŒŸ/ì”ì•¡ì€ ì›í™”(â‚©)ë¡œ í‘œì‹œ                            â”‚
â”‚  â”œâ”€â”€ ì˜ˆ: â‚©10,000 / â‚©50,000 ë¸”ë¼ì¸ë“œ                                  â”‚
â”‚  â””â”€â”€ ì‚¬ìš©ì ì¹œí™”ì  UI/UX                                              â”‚
â”‚                                                                      â”‚
â”‚  ì‹¤ì œ ì…ì¶œê¸ˆ: ì•”í˜¸í™”íë§Œ                                               â”‚
â”‚  â”œâ”€â”€ ì§€ì› ì½”ì¸: BTC, ETH, USDT, USDC ë“±                              â”‚
â”‚  â”œâ”€â”€ ì…ê¸ˆ ì‹œ ì‹¤ì‹œê°„ í™˜ìœ¨ë¡œ KRW ë³€í™˜                                   â”‚
â”‚  â”œâ”€â”€ ì¶œê¸ˆ ì‹œ KRW â†’ ì•”í˜¸í™”í í™˜ì‚°                                      â”‚
â”‚  â””â”€â”€ Crypto Payment Gateway ì—°ë™ (Phase 5)                           â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¯ 300-500ëª… ë™ì‹œ ì ‘ì† ë°±ì—”ë“œ ì•„í‚¤í…ì²˜                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ë™ì‹œ ì ‘ì†: 300-500ëª… (ê¸°ì¡´ 100ëª… ëŒ€ë¹„ 3-5ë°° í™•ì¥)                    â”‚
â”‚  í™œì„± í…Œì´ë¸”: 50-80ê°œ (í…Œì´ë¸”ë‹¹ 6-9ëª…)                                â”‚
â”‚  WebSocket ì—°ê²°: 500-700ê°œ (ì—¬ìœ ë¶„ í¬í•¨)                              â”‚
â”‚  API ì‘ë‹µ: p95 < 150ms, p99 < 300ms                                  â”‚
â”‚  ê°€ìš©ì„±: 99.9% (ì›” 43ë¶„ ì´í•˜ ë‹¤ìš´íƒ€ì„)                                â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš¨ ì„¸ì…˜ ì¤‘ë‹¨ ëŒ€ë¹„ í•„ìˆ˜ ì§€ì¹¨ (ì¤‘ìš”!)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âš ï¸ í•„ìˆ˜: í† í° í•œë„ë¡œ ì‘ì—…ì´ ê°‘ìê¸° ì¤‘ë‹¨ë  ìˆ˜ ìˆìŒ                       â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘  ğŸ“Œ ì‘ì—… ì¬ê°œ ë°©ë²•:                                                    â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘  1. ì´ íŒŒì¼(BACKEND_SCALE_WORKPLAN.md) ì—´ê¸°                            â•‘
â•‘  2. ë§ˆì§€ë§‰ìœ¼ë¡œ [x] ì²´í¬ëœ ë‹¨ê³„ í™•ì¸                                     â•‘
â•‘  3. ë‹¤ìŒ ëª…ë ¹ìœ¼ë¡œ ì¬ê°œ:                                                 â•‘
â•‘     "BACKEND_SCALE_WORKPLAN.md ì½ê³  [X.X]ë‹¨ê³„ë¶€í„° ì´ì–´ì„œ ì‘ì—…í•´ì¤˜"     â•‘
â•‘                                                                        â•‘
â•‘  ğŸ“Œ í•„ìˆ˜ ê·œì¹™:                                                         â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘  âœ“ ê° í•˜ìœ„ ì‘ì—… ì™„ë£Œ ì¦‰ì‹œ [ ] â†’ [x] ì²´í¬                               â•‘
â•‘  âœ“ ë‹¨ê³„ ì™„ë£Œ ì‹œ "**[x] X.X ì™„ë£Œ**" ì²´í¬ + ë‚ ì§œ/ì‹œê°„ ê¸°ë¡               â•‘
â•‘  âœ“ Phase ì™„ë£Œ ì‹œ git commit ì‹¤í–‰                                       â•‘
â•‘  âœ“ ì‘ì—… ì¤‘ë‹¨ ì „ ë°˜ë“œì‹œ í˜„ì¬ ìƒíƒœ ì €ì¥ (git add .)                       â•‘
â•‘                                                                        â•‘
â•‘  ğŸ“Œ ì™„ë£Œ ì²´í¬ ì˜ˆì‹œ:                                                    â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
â•‘  - [x] config.py ìˆ˜ì •                                                  â•‘
â•‘  - [x] database.py ìˆ˜ì •                                                â•‘
â•‘  **[x] 1.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:30                        â•‘
â•‘                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## í˜„ì¬ ìƒíƒœ (2026-01-12 ê¸°ì¤€)

### ì™„ë£Œëœ ì‘ì—…

| êµ¬ë¶„ | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| ìŠ¤í™ ë¬¸ì„œ (P0~P6) | âœ… ì™„ë£Œ | 22ê°œ ë¬¸ì„œ |
| ê¸°ë³¸ êµ¬í˜„ (I0~I8) | âœ… ì™„ë£Œ | ë‹¨ì¼ ì„œë²„ ê¸°ì¤€ |
| ë³´ì•ˆ ì´ìŠˆ ìˆ˜ì • (15ë‹¨ê³„) | âœ… ì™„ë£Œ | HMAC ì„œëª…, Rate Limiting ë“± |
| ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸ (290ê°œ+) | âœ… ì™„ë£Œ | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ |
| WebSocket ê¸°ë³¸ | âœ… ì™„ë£Œ | ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ ê¸°ì¤€ |

### ë¯¸ì™„ë£Œ ì‘ì—… (ì´ ë¬¸ì„œ ë²”ìœ„)

| Phase | ì‘ì—… ë‚´ìš© | ìš°ì„ ìˆœìœ„ | ìƒíƒœ |
|-------|---------|---------|------|
| 1 | ì»¤ë„¥ì…˜ í’€/ì¸í”„ë¼ ê°•í™” | â­â­â­â­â­ | âœ… ì™„ë£Œ |
| 2 | WebSocket í´ëŸ¬ìŠ¤í„°ë§ (ê°•í™”) | â­â­â­â­â­ | âœ… ì™„ë£Œ |
| 3 | ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™” | â­â­â­â­â­ | â³ ëŒ€ê¸° |
| 4 | Redis ê³ ê°€ìš©ì„± + ê²Œì„ ìƒíƒœ ìºì‹± | â­â­â­â­â­ | â³ ëŒ€ê¸° |
| 5 | KRW ì”ì•¡ + ì•”í˜¸í™”í ì…ì¶œê¸ˆ | â­â­â­â­â­ | âœ… ì™„ë£Œ |
| 6 | Rake & ê²½ì œ ì‹œìŠ¤í…œ | â­â­â­â­ | â³ ëŒ€ê¸° |
| 7 | ë¶€í•˜ í…ŒìŠ¤íŠ¸ & íŠœë‹ | â­â­â­â­â­ | â³ ëŒ€ê¸° |
| 8 | ëª¨ë‹ˆí„°ë§ & ì•Œë¦¼ | â­â­â­â­ | â³ ëŒ€ê¸° |
| 9 | ìš´ì˜ ì•ˆì •í™” | â­â­â­ | â³ ëŒ€ê¸° |
| 10 | ì„±ëŠ¥ ìµœì í™” (Binary/JobQueue/ì••ì¶•) | â­â­â­â­ | â³ ëŒ€ê¸° |

---

## Phase 1: ì»¤ë„¥ì…˜ í’€ & ì¸í”„ë¼ ê°•í™”

> **ì˜ˆìƒ ê¸°ê°„**: 2-3ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (ìµœìš°ì„ )
> **í˜„ì¬ ìƒíƒœ**: âœ… ì™„ë£Œ

### 1.1 PostgreSQL ì»¤ë„¥ì…˜ í’€ í™•ì¥

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 1.1.1 config.py ìˆ˜ì •
- [x] `DATABASE_POOL_SIZE` í™˜ê²½ë³€ìˆ˜ ì¶”ê°€ (ê¸°ë³¸ê°’: 50)
- [x] `DATABASE_MAX_OVERFLOW` í™˜ê²½ë³€ìˆ˜ ì¶”ê°€ (ê¸°ë³¸ê°’: 30)
- [x] `DATABASE_POOL_TIMEOUT` í™˜ê²½ë³€ìˆ˜ ì¶”ê°€ (ê¸°ë³¸ê°’: 30ì´ˆ)
- [x] `DATABASE_POOL_RECYCLE` í™˜ê²½ë³€ìˆ˜ ì¶”ê°€ (ê¸°ë³¸ê°’: 1800ì´ˆ)

```python
# backend/app/config.py ìˆ˜ì • ë‚´ìš©
database_pool_size: int = Field(default=50, description="DB connection pool size")
database_max_overflow: int = Field(default=30, description="Max overflow connections")
database_pool_timeout: int = Field(default=30, description="Pool connection timeout")
database_pool_recycle: int = Field(default=1800, description="Connection recycle time")
```

#### 1.1.2 database.py ìˆ˜ì •
- [x] `create_async_engine` ì˜µì…˜ ì¶”ê°€
- [x] ì»¤ë„¥ì…˜ í’€ ì„¤ì • ì ìš©
- [x] ì»¤ë„¥ì…˜ ìƒíƒœ ëª¨ë‹ˆí„°ë§ ì¶”ê°€ (pool_pre_ping=True)

```python
# backend/app/database.py ìˆ˜ì • ë‚´ìš©
engine = create_async_engine(
    settings.database_url,
    pool_size=settings.database_pool_size,
    max_overflow=settings.database_max_overflow,
    pool_timeout=settings.database_pool_timeout,
    pool_recycle=settings.database_pool_recycle,
    pool_pre_ping=True,  # ì—°ê²° ìƒíƒœ í™•ì¸
    echo=settings.debug,
)
```

**[x] 1.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 14:50

---

### 1.2 Redis ì—°ê²° í’€ í™•ì¥

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 1.2.1 Redis ì„¤ì • ì¶”ê°€
- [x] `REDIS_MAX_CONNECTIONS` í™˜ê²½ë³€ìˆ˜ ì¶”ê°€ (ê¸°ë³¸ê°’: 100)
- [x] `REDIS_SOCKET_TIMEOUT` í™˜ê²½ë³€ìˆ˜ ì¶”ê°€ (ê¸°ë³¸ê°’: 5ì´ˆ)
- [x] `REDIS_SOCKET_CONNECT_TIMEOUT` í™˜ê²½ë³€ìˆ˜ ì¶”ê°€ (ê¸°ë³¸ê°’: 5ì´ˆ)

#### 1.2.2 Redis í´ë¼ì´ì–¸íŠ¸ ìˆ˜ì •
- [x] ì»¤ë„¥ì…˜ í’€ ìƒì„± (ConnectionPool.from_url)
- [x] ì¬ì—°ê²° ë¡œì§ ê°•í™” (retry_on_timeout=True, health_check_interval)

```python
# backend/app/redis.py ìˆ˜ì • ë‚´ìš©
from redis.asyncio import ConnectionPool, Redis

pool = ConnectionPool.from_url(
    settings.redis_url,
    max_connections=settings.redis_max_connections,
    socket_timeout=settings.redis_socket_timeout,
    socket_connect_timeout=settings.redis_socket_connect_timeout,
    retry_on_timeout=True,
    health_check_interval=30,
)

redis = Redis(connection_pool=pool)
```

**[x] 1.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 14:52

---

### 1.3 Uvicorn Workers ì„¤ì •

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 1.3.1 ë©€í‹° ì›Œì»¤ ì„¤ì •
- [x] `UVICORN_WORKERS` í™˜ê²½ë³€ìˆ˜ ì¶”ê°€ (ê¸°ë³¸ê°’: 1, í”„ë¡œë•ì…˜: 4-8)
- [x] main.pyì— í”„ë¡œë•ì…˜ ëª¨ë“œ ë©€í‹° ì›Œì»¤ ì„¤ì • ì¶”ê°€

```bash
# ì§ì ‘ ì‹¤í–‰
uvicorn app.main:app --workers 4 --host 0.0.0.0 --port 8000

# ë˜ëŠ” Gunicorn (ë” ì•ˆì •ì )
gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker
```

#### 1.3.2 WebSocket ì£¼ì˜ì‚¬í•­
- [x] ë©€í‹° ì›Œì»¤ ì‹œ WebSocket sticky session ë˜ëŠ” Redis Pub/Sub í•„ìˆ˜ (ì£¼ì„ ë¬¸ì„œí™”)
- [x] Phase 2ì—ì„œ ì²˜ë¦¬ ì˜ˆì •

**[x] 1.3 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 14:55

---

### 1.4 ì„œë²„ ë¦¬ì†ŒìŠ¤ ê¶Œì¥ ì‚¬ì–‘

**ìƒíƒœ**: [x] ì™„ë£Œ (ë¬¸ì„œí™”)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  500ëª… ë™ì‹œ ì ‘ì† ê¶Œì¥ ì‚¬ì–‘                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ì˜µì…˜ A: ê³ ì„±ëŠ¥ ë‹¨ì¼ ì„œë²„                                             â”‚
â”‚  â”œâ”€â”€ CPU: 8ì½”ì–´                                                      â”‚
â”‚  â”œâ”€â”€ RAM: 16GB                                                       â”‚
â”‚  â”œâ”€â”€ SSD: 100GB+                                                     â”‚
â”‚  â”œâ”€â”€ ë„¤íŠ¸ì›Œí¬: 1Gbps                                                 â”‚
â”‚  â””â”€â”€ ì˜ˆìƒ ë¹„ìš©: $100-200/ì›”                                          â”‚
â”‚                                                                      â”‚
â”‚  ì˜µì…˜ B: ë¶„ë¦¬ëœ ì„œë²„ (ê¶Œì¥)                                           â”‚
â”‚  â”œâ”€â”€ App Server: 4ì½”ì–´ 8GB Ã— 2ëŒ€                                     â”‚
â”‚  â”œâ”€â”€ DB Server: 4ì½”ì–´ 16GB Ã— 1ëŒ€                                     â”‚
â”‚  â”œâ”€â”€ Redis Server: 2ì½”ì–´ 4GB Ã— 1ëŒ€                                   â”‚
â”‚  â””â”€â”€ ì˜ˆìƒ ë¹„ìš©: $150-300/ì›”                                          â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**[x] 1.4 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 14:56

---

### Phase 1 ì™„ë£Œ ì²´í¬

```bash
# Phase 1 ì™„ë£Œ ì‹œ ì‹¤í–‰
git add .
git commit -m "Phase 1 ì™„ë£Œ: ì»¤ë„¥ì…˜ í’€ & ì¸í”„ë¼ ê°•í™”

- PostgreSQL ì»¤ë„¥ì…˜ í’€ 50+30 ì„¤ì •
- Redis ì»¤ë„¥ì…˜ í’€ 100 ì„¤ì •
- Uvicorn ë©€í‹° ì›Œì»¤ ì„¤ì •
- ì„œë²„ ì‚¬ì–‘ ë¬¸ì„œí™”"
```

**[x] Phase 1 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 14:56

---

## Phase 2: WebSocket í´ëŸ¬ìŠ¤í„°ë§ (ê°•í™”)

> **ì˜ˆìƒ ê¸°ê°„**: 4-6ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (ìµœìš°ì„ )
> **í˜„ì¬ ìƒíƒœ**: âœ… ì™„ë£Œ
> **v1.2 ì¶”ê°€**: Sticky Session, Redis Adapter, ê³ ê¸‰ ì¥ì•  ë³µêµ¬

### 2.1 Redis Pub/Sub ë¸Œë¡œë“œìºìŠ¤íŠ¸ êµ¬í˜„

**ìƒíƒœ**: [x] ì™„ë£Œ (ê¸°ì¡´ ConnectionManagerì— ì´ë¯¸ êµ¬í˜„ë¨)

#### 2.1.1 PubSubManager í´ë˜ìŠ¤ ìƒì„±
- [x] `backend/app/ws/manager.py` - ConnectionManagerì— í†µí•© êµ¬í˜„
- [x] ì±„ë„ë³„ êµ¬ë…/ë°œí–‰ ë¡œì§ êµ¬í˜„ (`ws:pubsub:*` íŒ¨í„´)
- [x] ë¡œë¹„/í…Œì´ë¸”ë³„ ì±„ë„ ë¶„ë¦¬

```python
# backend/app/ws/pubsub.py
import asyncio
import json
from redis.asyncio import Redis

class PubSubManager:
    """Redis Pub/Sub ê¸°ë°˜ WebSocket ë¸Œë¡œë“œìºìŠ¤íŠ¸ ê´€ë¦¬"""

    def __init__(self, redis: Redis):
        self._redis = redis
        self._pubsub = redis.pubsub()
        self._channels: dict[str, set] = {}
        self._running = False

    async def start(self):
        """Pub/Sub ë¦¬ìŠ¤ë„ˆ ì‹œì‘"""
        self._running = True
        asyncio.create_task(self._listen_loop())

    async def publish(self, channel: str, message: dict):
        """ë©”ì‹œì§€ ë°œí–‰ (ëª¨ë“  ì›Œì»¤ì— ì „ë‹¬)"""
        await self._redis.publish(channel, json.dumps(message))
```

#### 2.1.2 ì±„ë„ ëª…ëª… ê·œì¹™
- [x] ë¡œë¹„ ì±„ë„: `lobby`
- [x] í…Œì´ë¸” ì±„ë„: `table:{table_id}`
- [x] ì‚¬ìš©ì ì±„ë„: `user:{user_id}` (ê°œì¸ ì•Œë¦¼ìš©)

**[x] 2.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:20 (ê¸°ì¡´ êµ¬í˜„ í™•ì¸)

---

### 2.2 ConnectionManager ë¦¬íŒ©í† ë§

**ìƒíƒœ**: [x] ì™„ë£Œ (ê¸°ì¡´ êµ¬í˜„ì— ì—°ê²° ì œí•œ ì¶”ê°€)

#### 2.2.1 ConnectionManager ìˆ˜ì •
- [x] `backend/app/ws/manager.py` - ì´ë¯¸ Redis Pub/Sub ì§€ì›
- [x] ë¡œì»¬ ì—°ê²° ê´€ë¦¬ + Redis Pub/Sub ì—°ë™
- [x] ì—°ê²° ìƒíƒœ Redis ì €ì¥ (`ws:connections:{user_id}`)

**[x] 2.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:20

---

### 2.3 í…Œì´ë¸” ìƒíƒœ Redis ë™ê¸°í™”

**ìƒíƒœ**: [x] ì™„ë£Œ (ê¸°ì¡´ êµ¬í˜„)

#### 2.3.1 í…Œì´ë¸” ìƒíƒœ ì €ì¥
- [x] í…Œì´ë¸” ìƒì„± ì‹œ Redisì— ìƒíƒœ ì €ì¥
- [x] ìƒíƒœ ë³€ê²½ ì‹œ Redis ì—…ë°ì´íŠ¸
- [x] ìƒíƒœ ì¡°íšŒ ì‹œ Redisì—ì„œ ë¨¼ì € í™•ì¸

**[x] 2.3 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:20

---

### 2.4 Heartbeat ê°•í™”

**ìƒíƒœ**: [x] ì™„ë£Œ (ê¸°ì¡´ êµ¬í˜„)

- [x] ì—°ê²°ë³„ ë§ˆì§€ë§‰ heartbeat ì‹œê°„ ì¶”ì  (`last_ping_at`)
- [x] 60ì´ˆ ì´ìƒ ë¯¸ì‘ë‹µ ì‹œ ì—°ê²° ì •ë¦¬ (`SERVER_TIMEOUT = 60`)
- [x] Redis ì—°ê²° ì •ë³´ TTL ê°±ì‹ 

**[x] 2.4 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:20

---

### 2.5 WebSocket ì—°ê²° ì œí•œ

**ìƒíƒœ**: [x] ì™„ë£Œ

- [x] `WS_MAX_CONNECTIONS` í™˜ê²½ë³€ìˆ˜ (ê¸°ë³¸ê°’: 600)
- [x] `WS_MAX_CONNECTIONS_PER_USER` í™˜ê²½ë³€ìˆ˜ (ê¸°ë³¸ê°’: 3)
- [x] ì´ˆê³¼ ì‹œ ê°€ì¥ ì˜¤ë˜ëœ ì—°ê²° ì¢…ë£Œ (`_get_oldest_user_connection`)

**[x] 2.5 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:30

---

### 2.6 Sticky Session ì„¤ì • (v1.2 ì¶”ê°€)

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 2.6.1 ë¡œë“œë°¸ëŸ°ì„œ ì„¤ì •
- [x] Nginx/HAProxy sticky session ì„¤ì • (`infra/nginx/nginx.prod.conf`)
- [x] IP í•´ì‹œ ê¸°ë°˜ ì„¸ì…˜ ìœ ì§€ (`ip_hash;`)

```nginx
# nginx.conf - IP Hash ë°©ì‹
upstream backend {
    ip_hash;
    server app1:8000;
    server app2:8000;
    server app3:8000;
}

# ë˜ëŠ” ì¿ í‚¤ ê¸°ë°˜ (ë” ì •í™•)
upstream backend {
    server app1:8000;
    server app2:8000;
    sticky cookie srv_id expires=1h;
}
```

#### 2.6.2 WebSocket ì—…ê·¸ë ˆì´ë“œ ì²˜ë¦¬
- [x] Connection: Upgrade í—¤ë” ì²˜ë¦¬
- [x] 101 Switching Protocols ì „ë‹¬

```nginx
location /ws {
    proxy_pass http://backend;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_read_timeout 86400;
}
```

**[x] 2.6 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:35

---

### 2.7 ì›Œì»¤ ê°„ ì¥ì•  ë³µêµ¬ (v1.2 ì¶”ê°€)

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 2.7.1 ì›Œì»¤ ìƒíƒœ ëª¨ë‹ˆí„°ë§
- [x] Redisì— ì›Œì»¤ë³„ ì—°ê²° ìˆ˜ ì €ì¥ (`ws:workers`, `ws:worker:{id}:alive`)
- [x] ì›Œì»¤ ë¹„ì •ìƒ ì¢…ë£Œ ê°ì§€ (TTL 30ì´ˆ, 5ì´ˆë§ˆë‹¤ heartbeat)

```python
# backend/app/ws/worker_health.py
class WorkerHealthManager:
    """ì›Œì»¤ ìƒíƒœ ê´€ë¦¬"""

    async def register_worker(self, worker_id: str):
        """ì›Œì»¤ ë“±ë¡ (TTL 30ì´ˆ)"""
        await self._redis.setex(
            f"worker:{worker_id}:alive",
            30,
            datetime.utcnow().isoformat()
        )

    async def heartbeat(self, worker_id: str):
        """ì›Œì»¤ heartbeat (5ì´ˆë§ˆë‹¤)"""
        await self._redis.setex(
            f"worker:{worker_id}:alive",
            30,
            datetime.utcnow().isoformat()
        )

    async def cleanup_dead_worker(self, worker_id: str):
        """ì£½ì€ ì›Œì»¤ì˜ ì—°ê²° ì •ë¦¬"""
        # í•´ë‹¹ ì›Œì»¤ì˜ ì—°ê²° ì •ë³´ ì‚­ì œ
        # ì—°ê²°ëœ ì‚¬ìš©ìë“¤ì—ê²Œ ì¬ì—°ê²° ìœ ë„
        pass
```

#### 2.7.2 ì—°ê²° ë§ˆì´ê·¸ë ˆì´ì…˜
- [x] ì›Œì»¤ ì¢…ë£Œ ì‹œ Redisì—ì„œ ì—°ê²° ì •ë³´ ì •ë¦¬ (`_cleanup_worker_connections`)
- [x] í´ë¼ì´ì–¸íŠ¸ ì¬ì—°ê²° ì‹œ ìƒíƒœ ë³µì› (`store_user_state`, `get_user_state`)

**[x] 2.7 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:40

---

### Phase 2 ì™„ë£Œ ì²´í¬

```bash
git add .
git commit -m "Phase 2 ì™„ë£Œ: WebSocket í´ëŸ¬ìŠ¤í„°ë§ (ê°•í™”)

- Redis Pub/Sub ë¸Œë¡œë“œìºìŠ¤íŠ¸ êµ¬í˜„ (ê¸°ì¡´ êµ¬í˜„ í™•ì¸)
- ConnectionManager ë©€í‹° ì›Œì»¤ ì§€ì› (ì—°ê²° ì œí•œ ì¶”ê°€)
- í…Œì´ë¸” ìƒíƒœ Redis ë™ê¸°í™” (ê¸°ì¡´ êµ¬í˜„)
- Heartbeat ê°•í™” (60ì´ˆ íƒ€ì„ì•„ì›ƒ)
- ì—°ê²° ìˆ˜ ì œí•œ (ì „ì—­ 600, ì‚¬ìš©ìë‹¹ 3)
- Sticky Session ì„¤ì • (Nginx nginx.prod.conf)
- ì›Œì»¤ ê°„ ì¥ì•  ë³µêµ¬ (WorkerHealthManager)"
```

**[x] Phase 2 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:40

---

## Phase 3: ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”

> **ì˜ˆìƒ ê¸°ê°„**: 3-4ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (ìµœìš°ì„ )
> **í˜„ì¬ ìƒíƒœ**: âœ… ì™„ë£Œ

### 3.1 ì¸ë±ìŠ¤ ìµœì í™”

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 3.1.1 í•µì‹¬ ì¸ë±ìŠ¤ ì¶”ê°€

```sql
-- ì‚¬ìš©ì ì¡°íšŒ (ì´ë¯¸ ì¡´ì¬)
CREATE UNIQUE INDEX ix_users_email ON users(email);
CREATE UNIQUE INDEX ix_users_nickname ON users(nickname);

-- ë°©/í…Œì´ë¸” ì¡°íšŒ (ix_rooms_status ì¡´ì¬, created_at DESC ì¶”ê°€)
CREATE INDEX ix_rooms_created_at_desc ON rooms(created_at DESC);
CREATE INDEX ix_rooms_status_created_at ON rooms(status, created_at DESC);

-- í•¸ë“œ íˆìŠ¤í† ë¦¬ (ix_hands_table_id ì¡´ì¬, started_at DESC ì¶”ê°€)
CREATE INDEX ix_hands_started_at_desc ON hands(started_at DESC);
CREATE INDEX ix_hands_table_started_at ON hands(table_id, started_at DESC);

-- ë³µí•© ì¸ë±ìŠ¤ ì¶”ê°€
CREATE INDEX ix_hand_events_hand_seq ON hand_events(hand_id, seq_no);
CREATE INDEX ix_sessions_expires_at ON sessions(expires_at);

-- íŠ¸ëœì­ì…˜ ì¡°íšŒ (Phase 5ì—ì„œ wallet_transactions í…Œì´ë¸” ìƒì„± ì‹œ ì¶”ê°€)
```

- [x] Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„± (`add_performance_indexes.py`)
- [ ] ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ (ë°°í¬ ì‹œ)
- [ ] ì¸ë±ìŠ¤ ì‚¬ìš© í™•ì¸ (EXPLAIN ANALYZE)

**[x] 3.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 16:30

---

### 3.2 ì¿¼ë¦¬ ìµœì í™”

**ìƒíƒœ**: [x] ì™„ë£Œ

- [x] N+1 ì¿¼ë¦¬ ì œê±° (`selectinload`, `joinedload`)
  - RoomService: ì´ë¯¸ selectinload ì‚¬ìš©
  - TableHandler: `_get_table_by_id_or_room`ì— `joinedload(Table.room)` ì¶”ê°€
- [x] ë°°ì¹˜ ì¡°íšŒ ì ìš© (IN ì ˆ)
  - `backend/app/utils/query_optimization.py` ìœ í‹¸ë¦¬í‹° ìƒì„±
  - `batch_get_by_ids()`, `batch_get_with_related()` í•¨ìˆ˜ ì¶”ê°€
- [x] í˜ì´ì§€ë„¤ì´ì…˜ ìµœì í™”
  - `paginate_with_cursor()` ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§€ë„¤ì´ì…˜ í•¨ìˆ˜ ì¶”ê°€

**[x] 3.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 16:45

---

### 3.3 PostgreSQL íŠœë‹

**ìƒíƒœ**: [x] ì™„ë£Œ

```conf
# 500ëª… ë™ì‹œ ì ‘ì† ê¸°ì¤€ (infra/postgres/postgresql.prod.conf)
max_connections = 150
shared_buffers = 4GB
effective_cache_size = 12GB
work_mem = 32MB
maintenance_work_mem = 1GB
random_page_cost = 1.1  # SSD ìµœì í™”
effective_io_concurrency = 200  # SSD ìµœì í™”
autovacuum_vacuum_scale_factor = 0.1  # ìë™ vacuum ë¯¼ê°ë„ ì¦ê°€
```

ì¶”ê°€ íŒŒì¼ ìƒì„±:
- `infra/postgres/postgresql.prod.conf`: í”„ë¡œë•ì…˜ PostgreSQL ì„¤ì •
- `infra/postgres/init.sql`: ëª¨ë‹ˆí„°ë§ ë·° ë° ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸

**[x] 3.3 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 17:00

---

### Phase 3 ì™„ë£Œ ì²´í¬

```bash
git add .
git commit -m "Phase 3 ì™„ë£Œ: ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”

- í•µì‹¬ í…Œì´ë¸” ì¸ë±ìŠ¤ ì¶”ê°€ (Alembic ë§ˆì´ê·¸ë ˆì´ì…˜)
- N+1 ì¿¼ë¦¬ ì œê±° (joinedload, selectinload)
- ë°°ì¹˜ ì¡°íšŒ ìœ í‹¸ë¦¬í‹° (query_optimization.py)
- PostgreSQL í”„ë¡œë•ì…˜ íŠœë‹ ì„¤ì •"
```

**[x] Phase 3 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 17:00

---

## Phase 4: Redis ê³ ê°€ìš©ì„± + ê²Œì„ ìƒíƒœ ìºì‹±

> **ì˜ˆìƒ ê¸°ê°„**: 4-5ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (ìµœìš°ì„ ìœ¼ë¡œ ìƒí–¥)
> **í˜„ì¬ ìƒíƒœ**: âœ… ì™„ë£Œ
> **v1.2 ì¶”ê°€**: ê²Œì„ ìƒíƒœ ì¤‘ì‹¬ ìºì‹± (DB ë¶€í•˜ 70-90% ê°ì†Œ ëª©í‘œ)

### 4.1 Redis ë©”ëª¨ë¦¬ ì •ì±… ì„¤ì •

**ìƒíƒœ**: [x] ì™„ë£Œ

```conf
maxmemory 2gb
maxmemory-policy allkeys-lru
maxclients 500
```

**[x] 4.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 18:00
- ìƒì„± íŒŒì¼: `infra/redis/redis.prod.conf`

---

### 4.2 Redis ìºì‹œ ì „ëµ

**ìƒíƒœ**: [x] ì™„ë£Œ

- [x] ìºì‹œ í‚¤ ì„¤ê³„ (TTL ì •ì±…)
- [x] ìºì‹œ ë¬´íš¨í™” ì „ëµ

**[x] 4.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 18:05
- ìƒì„± íŒŒì¼: `backend/app/cache/keys.py`

---

### 4.3 ê²Œì„ ìƒíƒœ Redis ì¤‘ì‹¬ ìºì‹± (v1.2 ì¶”ê°€)

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 4.3.1 í…Œì´ë¸” ìƒíƒœ Redis Hash ì €ì¥
- [x] `backend/app/cache/table_cache.py` ìƒì„±
- [x] í…Œì´ë¸” ìƒíƒœë¥¼ Redis Hashë¡œ ê´€ë¦¬
- [x] DBëŠ” ì˜êµ¬ ì €ì¥ìš©ìœ¼ë¡œë§Œ ì‚¬ìš© (write-behind)

```python
# backend/app/cache/table_cache.py
class TableCacheService:
    """í…Œì´ë¸” ìƒíƒœ Redis ìºì‹± (DB ë¶€í•˜ 90% ê°ì†Œ)"""

    KEY_PREFIX = "table:"

    async def get_table_state(self, table_id: str) -> TableState | None:
        """Redisì—ì„œ í…Œì´ë¸” ìƒíƒœ ì¡°íšŒ (ìºì‹œ íˆíŠ¸)"""
        data = await self._redis.hgetall(f"{self.KEY_PREFIX}{table_id}")
        if data:
            return TableState.from_cache(data)
        return None

    async def set_table_state(self, table_id: str, state: TableState):
        """Redisì— í…Œì´ë¸” ìƒíƒœ ì €ì¥"""
        await self._redis.hset(
            f"{self.KEY_PREFIX}{table_id}",
            mapping=state.to_cache_dict()
        )
        await self._redis.expire(f"{self.KEY_PREFIX}{table_id}", 3600)

    async def update_player_stack(self, table_id: str, position: int, stack: int):
        """í”Œë ˆì´ì–´ ìŠ¤íƒë§Œ ì—…ë°ì´íŠ¸ (ë¶€ë¶„ ì—…ë°ì´íŠ¸)"""
        await self._redis.hset(
            f"{self.KEY_PREFIX}{table_id}",
            f"seat:{position}:stack",
            stack
        )
```

#### 4.3.2 í•¸ë“œ ìƒíƒœ ì‹¤ì‹œê°„ ìºì‹±
- [x] ì§„í–‰ ì¤‘ì¸ í•¸ë“œëŠ” Redisì—ë§Œ ì €ì¥
- [x] í•¸ë“œ ì¢…ë£Œ ì‹œ DBì— ë°°ì¹˜ ì €ì¥
- ìƒì„± íŒŒì¼: `backend/app/cache/hand_cache.py`

```python
# í•¸ë“œ ìƒíƒœ í‚¤ êµ¬ì¡°
HAND_KEY = "hand:{hand_id}"
HAND_FIELDS = {
    "phase": "flop",
    "pot": "1500",
    "community_cards": "Ah,Kd,Qc",
    "current_turn": "3",
    "action_history": "[...]",  # JSON
}
```

**[x] 4.3 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 18:15

---

### 4.4 ìºì‹œ-DB ë™ê¸°í™” ì „ëµ (v1.2 ì¶”ê°€)

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 4.4.1 Write-Behind íŒ¨í„´
- [x] ì‹¤ì‹œê°„ ë³€ê²½ì€ Redisì—ë§Œ ë°˜ì˜
- [x] 5ì´ˆë§ˆë‹¤ ë˜ëŠ” í•¸ë“œ ì¢…ë£Œ ì‹œ DB ë™ê¸°í™”
- ìƒì„± íŒŒì¼: `backend/app/cache/sync_service.py`

```python
# backend/app/cache/sync_service.py
class CacheSyncService:
    """ìºì‹œ â†’ DB ë™ê¸°í™”"""

    SYNC_INTERVAL = 5  # ì´ˆ

    async def sync_table_to_db(self, table_id: str):
        """í…Œì´ë¸” ìƒíƒœ DB ë™ê¸°í™”"""
        state = await self._cache.get_table_state(table_id)
        if state and state.is_dirty:
            await self._db.update_table(table_id, state)
            state.mark_clean()

    async def sync_on_hand_complete(self, hand_id: str):
        """í•¸ë“œ ì™„ë£Œ ì‹œ ì¦‰ì‹œ ë™ê¸°í™”"""
        # í•¸ë“œ íˆìŠ¤í† ë¦¬ DB ì €ì¥
        # í”Œë ˆì´ì–´ ì”ì•¡ DB ì—…ë°ì´íŠ¸
        pass
```

#### 4.4.2 ìºì‹œ ì›Œë°ì—…
- [x] ì„œë²„ ì‹œì‘ ì‹œ í™œì„± í…Œì´ë¸” ìºì‹œ ë¡œë“œ
- [x] ì¬ì ‘ì† ì‹œ ìºì‹œì—ì„œ ìƒíƒœ ë³µì›
- ìƒì„± íŒŒì¼: `backend/app/cache/warmup.py`

**[x] 4.4 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 18:20

---

### Phase 4 ì™„ë£Œ ì²´í¬

```bash
git add .
git commit -m "Phase 4 ì™„ë£Œ: Redis ê³ ê°€ìš©ì„± + ê²Œì„ ìƒíƒœ ìºì‹±

- ë©”ëª¨ë¦¬ ì •ì±… ì„¤ì •
- ìºì‹œ í‚¤ ì„¤ê³„ ë° TTL ì •ì±…
- í…Œì´ë¸” ìƒíƒœ Redis Hash ìºì‹±
- Write-Behind íŒ¨í„´ ë™ê¸°í™”
- DB ë¶€í•˜ 70-90% ê°ì†Œ ë‹¬ì„±"
```

**[x] Phase 4 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 18:25

#### ìƒì„±ëœ íŒŒì¼ ëª©ë¡
- `infra/redis/redis.prod.conf` - Redis í”„ë¡œë•ì…˜ ì„¤ì •
- `backend/app/cache/__init__.py` - ìºì‹œ ëª¨ë“ˆ í†µí•©
- `backend/app/cache/keys.py` - ìºì‹œ í‚¤ ë° TTL ì •ì±…
- `backend/app/cache/table_cache.py` - í…Œì´ë¸” ìƒíƒœ ìºì‹±
- `backend/app/cache/hand_cache.py` - í•¸ë“œ ìƒíƒœ ìºì‹±
- `backend/app/cache/sync_service.py` - Write-Behind ë™ê¸°í™”
- `backend/app/cache/warmup.py` - ìºì‹œ ì›Œë°ì—…
- `backend/app/main.py` - ìºì‹œ ë§¤ë‹ˆì € í†µí•© (ìˆ˜ì •)

---

## Phase 5: KRW ì”ì•¡ + ì•”í˜¸í™”í ì…ì¶œê¸ˆ ì‹œìŠ¤í…œ

> **ì˜ˆìƒ ê¸°ê°„**: 7-10ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (ìµœìš°ì„ )
> **í˜„ì¬ ìƒíƒœ**: âœ… ì™„ë£Œ

### 5.1 User ëª¨ë¸ ì”ì•¡ í•„ë“œ (KRW ê¸°ì¤€)

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 5.1.1 ëª¨ë¸ ìˆ˜ì •
- [x] `krw_balance` í•„ë“œ ì¶”ê°€ (BigInteger, ê²Œì„ ë‚´ ì›í™” ì”ì•¡)
- [x] `pending_withdrawal_krw` í•„ë“œ ì¶”ê°€ (ì¶œê¸ˆ ëŒ€ê¸° ì›í™”)
- [x] ê¸°ì¡´ `balance` í•„ë“œ ë§ˆì´ê·¸ë ˆì´ì…˜

```python
# backend/app/models/user.py ìˆ˜ì •
class User(Base):
    __tablename__ = "users"

    id: Mapped[str] = mapped_column(String(36), primary_key=True)
    # ... ê¸°ì¡´ í•„ë“œ

    # ê²Œì„ ë‚´ KRW ì”ì•¡
    krw_balance: Mapped[int] = mapped_column(
        BigInteger, nullable=False, default=0,
        comment="Game balance in KRW (ì›í™”)"
    )

    # ì¶œê¸ˆ ëŒ€ê¸° ê¸ˆì•¡ (KRW)
    pending_withdrawal_krw: Mapped[int] = mapped_column(
        BigInteger, nullable=False, default=0,
        comment="Pending withdrawal in KRW"
    )
```

#### 5.1.2 ë§ˆì´ê·¸ë ˆì´ì…˜
- [x] Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„±
- [ ] ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ (ë°°í¬ ì‹œ)

**[x] 5.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:45

---

### 5.2 WalletTransaction ëª¨ë¸ (ì•”í˜¸í™”í ì§€ì›)

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 5.2.1 ëª¨ë¸ ìƒì„±
- [x] `backend/app/models/wallet.py` íŒŒì¼ ìƒì„±
- [x] TransactionType enum ì •ì˜
- [x] CryptoType enum ì •ì˜ (BTC, ETH, USDT, USDC)

```python
# backend/app/models/wallet.py
from enum import Enum

class CryptoType(str, Enum):
    BTC = "btc"
    ETH = "eth"
    USDT = "usdt"
    USDC = "usdc"

class TransactionType(str, Enum):
    CRYPTO_DEPOSIT = "crypto_deposit"    # ì•”í˜¸í™”í ì…ê¸ˆ â†’ KRW ë³€í™˜
    CRYPTO_WITHDRAWAL = "crypto_withdrawal"  # KRW â†’ ì•”í˜¸í™”í ì¶œê¸ˆ
    BUY_IN = "buy_in"        # í…Œì´ë¸” ì…ì¥
    CASH_OUT = "cash_out"    # í…Œì´ë¸” í‡´ì¥
    WIN = "win"              # íŒŸ íšë“
    LOSE = "lose"            # íŒŸ íŒ¨ë°°
    RAKE = "rake"            # ë ˆì´í¬ ì°¨ê°
    RAKEBACK = "rakeback"    # ë ˆì´í¬ë°± ì§€ê¸‰

class WalletTransaction(Base):
    __tablename__ = "wallet_transactions"

    id: Mapped[str] = mapped_column(String(36), primary_key=True)
    user_id: Mapped[str] = mapped_column(String(36), ForeignKey("users.id"))
    tx_type: Mapped[TransactionType] = mapped_column(SQLEnum(TransactionType))

    # KRW ê¸ˆì•¡ (ê²Œì„ ë‚´)
    krw_amount: Mapped[int] = mapped_column(BigInteger, default=0)
    krw_balance_after: Mapped[int] = mapped_column(BigInteger)

    # ì•”í˜¸í™”í ì •ë³´ (ì…ì¶œê¸ˆ ì‹œ)
    crypto_type: Mapped[CryptoType] = mapped_column(SQLEnum(CryptoType), nullable=True)
    crypto_amount: Mapped[str] = mapped_column(String(50), nullable=True)  # ì†Œìˆ˜ì  ì •ë°€ë„
    crypto_tx_hash: Mapped[str] = mapped_column(String(100), nullable=True)
    crypto_address: Mapped[str] = mapped_column(String(100), nullable=True)

    # í™˜ìœ¨ ì •ë³´
    exchange_rate: Mapped[int] = mapped_column(BigInteger, nullable=True)  # 1 crypto = X KRW

    # ë©”íƒ€ë°ì´í„°
    created_at: Mapped[datetime] = mapped_column(DateTime, default=datetime.utcnow)
    completed_at: Mapped[datetime] = mapped_column(DateTime, nullable=True)
    integrity_hash: Mapped[str] = mapped_column(String(64))
```

**[x] 5.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:50

---

### 5.3 CryptoDepositService êµ¬í˜„

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 5.3.1 ì…ê¸ˆ ì£¼ì†Œ ê´€ë¦¬
- [x] `backend/app/services/crypto_deposit.py` ìƒì„±
- [x] ì‚¬ìš©ìë³„ ì…ê¸ˆ ì£¼ì†Œ ë°œê¸‰/ê´€ë¦¬
- [x] ì…ê¸ˆ ê°ì§€ ì›¹í›… í•¸ë“¤ëŸ¬

```python
# backend/app/services/crypto_deposit.py
class CryptoDepositService:
    """ì•”í˜¸í™”í ì…ê¸ˆ ì„œë¹„ìŠ¤"""

    # ìµœì†Œ í™•ì¸ ìˆ˜
    MIN_CONFIRMATIONS = {
        CryptoType.BTC: 3,
        CryptoType.ETH: 12,
        CryptoType.USDT: 12,
        CryptoType.USDC: 12,
    }

    async def get_deposit_address(
        self,
        user_id: str,
        crypto_type: CryptoType
    ) -> str:
        """ì‚¬ìš©ìë³„ ì…ê¸ˆ ì£¼ì†Œ ì¡°íšŒ/ìƒì„±"""
        pass

    async def handle_deposit_webhook(
        self,
        crypto_type: CryptoType,
        tx_hash: str,
        address: str,
        amount: str,
        confirmations: int
    ):
        """ì…ê¸ˆ ê°ì§€ ì›¹í›… ì²˜ë¦¬"""
        # 1. í™•ì¸ ìˆ˜ ê²€ì¦
        # 2. ì‹¤ì‹œê°„ í™˜ìœ¨ ì¡°íšŒ
        # 3. KRW ë³€í™˜ ë° ì”ì•¡ ì¶”ê°€
        pass

    async def _convert_to_krw(
        self,
        crypto_type: CryptoType,
        amount: str
    ) -> tuple[int, int]:
        """ì•”í˜¸í™”í â†’ KRW ë³€í™˜ (ì”ì•¡, í™˜ìœ¨)"""
        pass
```

**[x] 5.3 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 16:00

---

### 5.4 CryptoWithdrawalService êµ¬í˜„

**ìƒíƒœ**: [x] ì™„ë£Œ

#### 5.4.1 ì¶œê¸ˆ ì„œë¹„ìŠ¤
- [x] `backend/app/services/crypto_withdrawal.py` ìƒì„±
- [x] 24ì‹œê°„ ëŒ€ê¸° ì •ì±…
- [x] ì¶œê¸ˆ í•œë„ ì„¤ì •

```python
# backend/app/services/crypto_withdrawal.py
class CryptoWithdrawalService:
    """ì•”í˜¸í™”í ì¶œê¸ˆ ì„œë¹„ìŠ¤"""

    PENDING_HOURS = 24  # ì¶œê¸ˆ ëŒ€ê¸° ì‹œê°„
    MIN_WITHDRAWAL_KRW = 10000  # ìµœì†Œ ì¶œê¸ˆ ê¸ˆì•¡ (â‚©10,000)
    MAX_AUTO_APPROVE_KRW = 1000000  # ìë™ ìŠ¹ì¸ í•œë„ (â‚©1,000,000)

    async def request_withdrawal(
        self,
        user_id: str,
        krw_amount: int,
        crypto_type: CryptoType,
        crypto_address: str
    ) -> WalletTransaction:
        """ì¶œê¸ˆ ìš”ì²­"""
        # 1. ì”ì•¡ í™•ì¸
        # 2. KRW â†’ ì•”í˜¸í™”í í™˜ì‚°
        # 3. pending_withdrawal_krwë¡œ ì´ë™
        # 4. 24ì‹œê°„ ëŒ€ê¸° ìƒíƒœë¡œ ì €ì¥
        pass

    async def process_pending_withdrawals(self):
        """ëŒ€ê¸° ì¤‘ì¸ ì¶œê¸ˆ ì²˜ë¦¬ (ìŠ¤ì¼€ì¤„ëŸ¬)"""
        pass
```

**[x] 5.4 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 16:10

---

### 5.5 í™˜ìœ¨ ì„œë¹„ìŠ¤

**ìƒíƒœ**: [x] ì™„ë£Œ

- [x] `backend/app/services/exchange_rate.py` ìƒì„±
- [x] ì‹¤ì‹œê°„ í™˜ìœ¨ API ì—°ë™ (CoinGecko, Binance ë“±)
- [x] í™˜ìœ¨ ìºì‹± (1ë¶„ TTL)

```python
# backend/app/services/exchange_rate.py
class ExchangeRateService:
    """ì‹¤ì‹œê°„ í™˜ìœ¨ ì„œë¹„ìŠ¤"""

    CACHE_TTL = 60  # 1ë¶„

    async def get_rate_to_krw(self, crypto_type: CryptoType) -> int:
        """1 ì•”í˜¸í™”í = X KRW"""
        pass

    async def convert_crypto_to_krw(
        self,
        crypto_type: CryptoType,
        amount: str
    ) -> int:
        """ì•”í˜¸í™”í â†’ KRW ë³€í™˜"""
        pass

    async def convert_krw_to_crypto(
        self,
        crypto_type: CryptoType,
        krw_amount: int
    ) -> str:
        """KRW â†’ ì•”í˜¸í™”í ë³€í™˜"""
        pass
```

**[x] 5.5 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 15:55

---

### 5.6 Redis Lua Script ë¶„ì‚°ë½ (KRW ì´ì²´)

**ìƒíƒœ**: [x] ì™„ë£Œ

- [x] `backend/app/utils/lua_scripts/krw_transfer.lua` ìƒì„±
- [x] ë¶„ì‚°ë½ + Atomic ì´ì²´

**[x] 5.6 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 16:05

---

### 5.7 WalletService êµ¬í˜„

**ìƒíƒœ**: [x] ì™„ë£Œ

- [x] `backend/app/services/wallet.py` ìƒì„±
- [x] `transfer_krw()` ë©”ì„œë“œ (í…Œì´ë¸” buy-in/cash-out)
- [ ] í…ŒìŠ¤íŠ¸ ì‘ì„± (Phase 7)

**[x] 5.7 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 16:15

---

### 5.8 AuditService 3ì¤‘ ê¸°ë¡

**ìƒíƒœ**: [x] ì™„ë£Œ

- [x] `backend/app/services/audit.py` ìƒì„±
- [x] DB + Redis Stream + íŒŒì¼ 3ì¤‘ ê¸°ë¡
- [x] ë¬´ê²°ì„± í•´ì‹œ

**[x] 5.8 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 16:20

---

### 5.9 ì…ì¶œê¸ˆ API ì—”ë“œí¬ì¸íŠ¸

**ìƒíƒœ**: [x] ì™„ë£Œ

- [x] `backend/app/api/wallet.py` ìƒì„±
- [x] GET /api/v1/wallet/deposit-address/{crypto_type}
- [x] POST /api/v1/wallet/withdraw
- [x] GET /api/v1/wallet/transactions
- [x] POST /api/v1/wallet/webhook/deposit (ë‚´ë¶€ìš©)

**[x] 5.9 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 16:25

---

### Phase 5 ì™„ë£Œ ì²´í¬

```bash
git add .
git commit -m "Phase 5 ì™„ë£Œ: KRW ì”ì•¡ + ì•”í˜¸í™”í ì…ì¶œê¸ˆ ì‹œìŠ¤í…œ

- User ëª¨ë¸ KRW ì”ì•¡ í•„ë“œ
- WalletTransaction ëª¨ë¸ (ì•”í˜¸í™”í ì§€ì›)
- CryptoDepositService ì…ê¸ˆ ì²˜ë¦¬
- CryptoWithdrawalService ì¶œê¸ˆ ì²˜ë¦¬ (24ì‹œê°„ ëŒ€ê¸°)
- ExchangeRateService ì‹¤ì‹œê°„ í™˜ìœ¨
- Redis Lua ë¶„ì‚°ë½
- AuditService 3ì¤‘ ê¸°ë¡
- ì…ì¶œê¸ˆ API ì—”ë“œí¬ì¸íŠ¸"
```

**[x] Phase 5 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: 2026-01-12 16:30

---

## Phase 6: Rake & ê²½ì œ ì‹œìŠ¤í…œ

> **ì˜ˆìƒ ê¸°ê°„**: 3-4ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­â­ (í•„ìˆ˜)
> **í˜„ì¬ ìƒíƒœ**: â³ ëŒ€ê¸°

### 6.1 RakeService êµ¬í˜„

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

```python
# backend/app/services/rake.py
RAKE_CONFIGS = {
    (1000, 2000): RakeConfig(Decimal("0.05"), 3),    # â‚©1,000/â‚©2,000
    (5000, 10000): RakeConfig(Decimal("0.05"), 4),   # â‚©5,000/â‚©10,000
    (25000, 50000): RakeConfig(Decimal("0.04"), 5),  # â‚©25,000/â‚©50,000
}
```

- [ ] RakeService êµ¬í˜„
- [ ] No Flop No Drop ë¡œì§
- [ ] Rake Cap ì ìš©
- [ ] í…ŒìŠ¤íŠ¸ ì‘ì„±

**[ ] 6.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 6.2 VIP & Rakeback ì‹œìŠ¤í…œ

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

```python
VIP_LEVELS = {
    "bronze": {"min_rake_krw": 0, "rakeback": Decimal("0.20")},
    "silver": {"min_rake_krw": 100000, "rakeback": Decimal("0.25")},
    "gold": {"min_rake_krw": 500000, "rakeback": Decimal("0.30")},
    "platinum": {"min_rake_krw": 2000000, "rakeback": Decimal("0.35")},
    "diamond": {"min_rake_krw": 5000000, "rakeback": Decimal("0.40")},
}
```

- [ ] VIP ë ˆë²¨ ê³„ì‚° ë¡œì§
- [ ] ì£¼ê°„ Rakeback ì •ì‚° Job

**[ ] 6.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### Phase 6 ì™„ë£Œ ì²´í¬

```bash
git add .
git commit -m "Phase 6 ì™„ë£Œ: Rake & ê²½ì œ ì‹œìŠ¤í…œ (KRW ê¸°ì¤€)

- RakeService êµ¬í˜„ (ë¸”ë¼ì¸ë“œë³„ ì„¤ì •)
- VIP ë ˆë²¨ ì‹œìŠ¤í…œ (Bronze~Diamond)
- RakebackService ì£¼ê°„ ì •ì‚°"
```

**[ ] Phase 6 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

## Phase 7: ë¶€í•˜ í…ŒìŠ¤íŠ¸ & íŠœë‹

> **ì˜ˆìƒ ê¸°ê°„**: 5-7ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (ìµœìš°ì„ )
> **í˜„ì¬ ìƒíƒœ**: â³ ëŒ€ê¸°

### 7.1 k6 ë¶€í•˜ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

- [ ] `k6/load-test-500.js` íŒŒì¼ ìƒì„±
- [ ] ë¡œê·¸ì¸ â†’ WebSocket â†’ ê²Œì„ ì‹œë®¬ë ˆì´ì…˜

**[ ] 7.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 7.2 ë‹¨ê³„ë³„ ë¶€í•˜ í…ŒìŠ¤íŠ¸

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

| ë‹¨ê³„ | ë™ì ‘ | ëª©í‘œ | ìƒíƒœ |
|------|------|------|------|
| 1 | 100ëª… | p95 < 100ms | [ ] |
| 2 | 200ëª… | p95 < 120ms | [ ] |
| 3 | 300ëª… | p95 < 150ms | [ ] |
| 4 | 400ëª… | p95 < 180ms | [ ] |
| 5 | 500ëª… | p95 < 200ms | [ ] |

**[ ] 7.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 7.3 ë³‘ëª© ë¶„ì„ & ìµœì í™”

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

- [ ] Slow Query Log ë¶„ì„
- [ ] Redis SLOWLOG í™•ì¸
- [ ] CPU/ë©”ëª¨ë¦¬ í”„ë¡œíŒŒì¼ë§

**[ ] 7.3 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### Phase 7 ì™„ë£Œ ì²´í¬

```bash
git add .
git commit -m "Phase 7 ì™„ë£Œ: ë¶€í•˜ í…ŒìŠ¤íŠ¸ & íŠœë‹

- k6 ë¶€í•˜ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
- 500ëª… ë™ì ‘ í…ŒìŠ¤íŠ¸ í†µê³¼
- p95 < 200ms ë‹¬ì„±"
```

**[ ] Phase 7 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

## Phase 8: ëª¨ë‹ˆí„°ë§ & ì•Œë¦¼

> **ì˜ˆìƒ ê¸°ê°„**: 2-3ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­â­ (ê¶Œì¥)
> **í˜„ì¬ ìƒíƒœ**: â³ ëŒ€ê¸°

### 8.1 Prometheus ë©”íŠ¸ë¦­ ì„¤ì •

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

- [ ] prometheus-fastapi-instrumentator ì„¤ì¹˜
- [ ] ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ ì •ì˜

**[ ] 8.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 8.2 Grafana ëŒ€ì‹œë³´ë“œ

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

- [ ] ëŒ€ì‹œë³´ë“œ JSON ìƒì„±
- [ ] í•µì‹¬ íŒ¨ë„ ì„¤ì •

**[ ] 8.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 8.3 ì•Œë¦¼ ì„¤ì •

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

- [ ] ì—ëŸ¬ìœ¨ > 1% â†’ Warning
- [ ] ì—ëŸ¬ìœ¨ > 5% â†’ Critical
- [ ] p95 > 500ms â†’ Warning

**[ ] 8.3 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### Phase 8 ì™„ë£Œ ì²´í¬

```bash
git add .
git commit -m "Phase 8 ì™„ë£Œ: ëª¨ë‹ˆí„°ë§ & ì•Œë¦¼

- Prometheus ë©”íŠ¸ë¦­ ì„¤ì •
- Grafana ëŒ€ì‹œë³´ë“œ
- ì•Œë¦¼ ê·œì¹™ ì„¤ì •"
```

**[ ] Phase 8 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

## Phase 9: ìš´ì˜ ì•ˆì •í™”

> **ì˜ˆìƒ ê¸°ê°„**: 3-5ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­ (ê¶Œì¥)
> **í˜„ì¬ ìƒíƒœ**: â³ ëŒ€ê¸°

### 9.1 Graceful Shutdown

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

- [ ] SIGTERM í•¸ë“¤ë§
- [ ] ì§„í–‰ ì¤‘ì¸ í•¸ë“œ ì™„ë£Œ ëŒ€ê¸°
- [ ] ì—°ê²° ì •ë¦¬

**[ ] 9.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 9.2 Health Check ì—”ë“œí¬ì¸íŠ¸

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

- [ ] `/health` ê¸°ë³¸
- [ ] `/health/ready` ì˜ì¡´ì„± í¬í•¨
- [ ] `/health/live` liveness probe

**[ ] 9.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 9.3 ë°±ì—… & ë³µêµ¬

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

- [ ] PostgreSQL ì¼ì¼ ë°±ì—…
- [ ] Redis RDB ìŠ¤ëƒ…ìƒ·
- [ ] ë³µêµ¬ í…ŒìŠ¤íŠ¸

**[ ] 9.3 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### Phase 9 ì™„ë£Œ ì²´í¬

```bash
git add .
git commit -m "Phase 9 ì™„ë£Œ: ìš´ì˜ ì•ˆì •í™”

- Graceful Shutdown
- Health Check ì—”ë“œí¬ì¸íŠ¸
- ë°±ì—… & ë³µêµ¬ ì „ëµ"
```

**[ ] Phase 9 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

## Phase 10: ì„±ëŠ¥ ìµœì í™” (v1.2 ì¶”ê°€)

> **ì˜ˆìƒ ê¸°ê°„**: 5-7ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­â­ (ê¶Œì¥)
> **í˜„ì¬ ìƒíƒœ**: â³ ëŒ€ê¸°
> **ëª©í‘œ**: ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨ 50-70% í–¥ìƒ, ë©”ì¸ ì„œë²„ ë¶€í•˜ ë¶„ì‚°

### 10.1 Binary WebSocket í”„ë¡œí† ì½œ (MessagePack)

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

#### 10.1.1 MessagePack ë„ì…
- [ ] `msgpack` íŒ¨í‚¤ì§€ ì„¤ì¹˜
- [ ] JSON â†’ MessagePack ë³€í™˜ ìœ í‹¸ë¦¬í‹°

```python
# backend/app/ws/serializer.py
import msgpack
from typing import Any

class MessageSerializer:
    """WebSocket ë©”ì‹œì§€ ì§ë ¬í™” (MessagePack)"""

    @staticmethod
    def encode(data: dict) -> bytes:
        """dict â†’ MessagePack bytes (50-70% í¬ê¸° ê°ì†Œ)"""
        return msgpack.packb(data, use_bin_type=True)

    @staticmethod
    def decode(data: bytes) -> dict:
        """MessagePack bytes â†’ dict"""
        return msgpack.unpackb(data, raw=False)
```

#### 10.1.2 í”„ë¡œí† ì½œ ë²„ì „ í˜‘ìƒ
- [ ] ì—°ê²° ì‹œ í´ë¼ì´ì–¸íŠ¸ ì§€ì› ì—¬ë¶€ í™•ì¸
- [ ] Binary ì§€ì› ì‹œ MessagePack, ë¯¸ì§€ì› ì‹œ JSON fallback

```python
# ì—°ê²° ì‹œ í˜‘ìƒ
async def negotiate_protocol(websocket: WebSocket) -> str:
    """í”„ë¡œí† ì½œ í˜‘ìƒ (binary/json)"""
    accept_binary = websocket.headers.get("X-Accept-Binary", "false")
    if accept_binary.lower() == "true":
        return "msgpack"
    return "json"
```

#### 10.1.3 ë©”ì‹œì§€ í¬ê¸° ë¹„êµ

| ì´ë²¤íŠ¸ | JSON | MessagePack | ê°ì†Œìœ¨ |
|--------|------|-------------|--------|
| TABLE_SNAPSHOT | 2.4KB | 0.9KB | 62% |
| TABLE_STATE_UPDATE | 800B | 280B | 65% |
| ACTION_RESULT | 300B | 120B | 60% |

**[ ] 10.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 10.2 Async Job Queue (Celery + Redis)

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

#### 10.2.1 Celery ì„¤ì •
- [ ] `celery` íŒ¨í‚¤ì§€ ì„¤ì¹˜
- [ ] `backend/app/tasks/celery_app.py` ìƒì„±

```python
# backend/app/tasks/celery_app.py
from celery import Celery

celery_app = Celery(
    "poker_tasks",
    broker="redis://localhost:6379/1",
    backend="redis://localhost:6379/2",
)

celery_app.conf.update(
    task_serializer="msgpack",
    accept_content=["msgpack"],
    result_serializer="msgpack",
    timezone="Asia/Seoul",
    enable_utc=True,
    task_routes={
        "tasks.settlement.*": {"queue": "settlement"},
        "tasks.analytics.*": {"queue": "analytics"},
        "tasks.notification.*": {"queue": "notification"},
    },
)
```

#### 10.2.2 ë¹„ë™ê¸° íƒœìŠ¤í¬ ì •ì˜
- [ ] ì •ì‚° íƒœìŠ¤í¬ (Rake ì§‘ê³„, VIP ë ˆë²¨ ê³„ì‚°)
- [ ] í†µê³„ íƒœìŠ¤í¬ (í”Œë ˆì´ì–´ í†µê³„, í…Œì´ë¸” í†µê³„)
- [ ] ì•Œë¦¼ íƒœìŠ¤í¬ (ì´ë©”ì¼, í‘¸ì‹œ)

```python
# backend/app/tasks/settlement.py
from app.tasks.celery_app import celery_app

@celery_app.task(bind=True, max_retries=3)
def calculate_weekly_rakeback(self):
    """ì£¼ê°„ ë ˆì´í¬ë°± ê³„ì‚° (ë¬´ê±°ìš´ ì‘ì—…)"""
    try:
        # ì „ì²´ ì‚¬ìš©ì ë ˆì´í¬ ì§‘ê³„
        # VIP ë ˆë²¨ë³„ ë ˆì´í¬ë°± ê³„ì‚°
        # ì§€ê¸‰ ë‚´ì—­ ìƒì„±
        pass
    except Exception as e:
        self.retry(countdown=60, exc=e)

@celery_app.task
def aggregate_daily_stats():
    """ì¼ì¼ í†µê³„ ì§‘ê³„"""
    # í•¸ë“œ ìˆ˜, ë ˆì´í¬ ì´ì•¡, í™œì„± ì‚¬ìš©ì ë“±
    pass
```

#### 10.2.3 Worker ì‹¤í–‰ ì„¤ì •
- [ ] Settlement Worker (ì •ì‚° ì „ìš©)
- [ ] Analytics Worker (í†µê³„ ì „ìš©)
- [ ] Notification Worker (ì•Œë¦¼ ì „ìš©)

```bash
# ì›Œì»¤ ì‹¤í–‰
celery -A app.tasks.celery_app worker -Q settlement -c 2
celery -A app.tasks.celery_app worker -Q analytics -c 2
celery -A app.tasks.celery_app worker -Q notification -c 2

# Beat (ìŠ¤ì¼€ì¤„ëŸ¬)
celery -A app.tasks.celery_app beat
```

**[ ] 10.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 10.3 í•¸ë“œ íˆìŠ¤í† ë¦¬ ì••ì¶• ì €ì¥

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

#### 10.3.1 ì••ì¶• ì €ì¥ í˜•ì‹
- [ ] `msgpack` + `gzip` ì¡°í•© (80% í¬ê¸° ê°ì†Œ)
- [ ] `backend/app/services/hand_archive.py` ìƒì„±

```python
# backend/app/services/hand_archive.py
import gzip
import msgpack
from datetime import datetime

class HandArchiveService:
    """í•¸ë“œ íˆìŠ¤í† ë¦¬ ì••ì¶• ì €ì¥"""

    async def archive_hand(self, hand_data: dict) -> bytes:
        """í•¸ë“œ ë°ì´í„° ì••ì¶•"""
        packed = msgpack.packb(hand_data)
        compressed = gzip.compress(packed, compresslevel=6)
        return compressed  # ì›ë³¸ ëŒ€ë¹„ 80-90% ê°ì†Œ

    async def retrieve_hand(self, compressed: bytes) -> dict:
        """ì••ì¶•ëœ í•¸ë“œ ë°ì´í„° ë³µì›"""
        decompressed = gzip.decompress(compressed)
        return msgpack.unpackb(decompressed, raw=False)
```

#### 10.3.2 ì¥ê¸° ë³´ê´€ ì „ëµ
- [ ] ìµœê·¼ 7ì¼: PostgreSQL (ë¹ ë¥¸ ì¡°íšŒ)
- [ ] 7ì¼~30ì¼: Redis (ì¤‘ê°„ ì†ë„)
- [ ] 30ì¼ ì´ìƒ: S3/ê°ì²´ ìŠ¤í† ë¦¬ì§€ (ì €ë¹„ìš©)

```python
# ì•„ì¹´ì´ë¸Œ ì •ì±…
ARCHIVE_POLICY = {
    "hot": {
        "storage": "postgresql",
        "retention_days": 7,
        "compression": False
    },
    "warm": {
        "storage": "redis",
        "retention_days": 30,
        "compression": True
    },
    "cold": {
        "storage": "s3",
        "retention_days": 365,
        "compression": True
    }
}
```

#### 10.3.3 ì €ì¥ ë¹„ìš© ì˜ˆì¸¡

| ì¼ì¼ í•¸ë“œ ìˆ˜ | ì›ë³¸ í¬ê¸° | ì••ì¶• í›„ | ì›”ê°„ S3 ë¹„ìš© |
|-------------|----------|---------|-------------|
| 10,000 | 50MB | 10MB | ~$0.30 |
| 50,000 | 250MB | 50MB | ~$1.50 |
| 100,000 | 500MB | 100MB | ~$3.00 |

**[ ] 10.3 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 10.4 ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ì • (Celery Beat)

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

- [ ] `backend/app/tasks/schedules.py` ìƒì„±
- [ ] ì£¼ê¸°ì  íƒœìŠ¤í¬ ë“±ë¡

```python
# backend/app/tasks/schedules.py
from celery.schedules import crontab

CELERY_BEAT_SCHEDULE = {
    # ë§¤ì‹œê°„: í•¸ë“œ íˆìŠ¤í† ë¦¬ ì•„ì¹´ì´ë¸Œ
    "archive-hands-hourly": {
        "task": "tasks.archive.archive_old_hands",
        "schedule": crontab(minute=0),
    },
    # ë§¤ì¼ ìƒˆë²½ 3ì‹œ: ì¼ì¼ í†µê³„ ì§‘ê³„
    "daily-stats": {
        "task": "tasks.analytics.aggregate_daily_stats",
        "schedule": crontab(hour=3, minute=0),
    },
    # ë§¤ì£¼ ì›”ìš”ì¼ ìƒˆë²½ 4ì‹œ: ì£¼ê°„ ë ˆì´í¬ë°± ì •ì‚°
    "weekly-rakeback": {
        "task": "tasks.settlement.calculate_weekly_rakeback",
        "schedule": crontab(hour=4, minute=0, day_of_week=1),
    },
    # ë§¤ì›” 1ì¼: ì›”ê°„ ì•„ì¹´ì´ë¸Œ S3 ì´ë™
    "monthly-archive-to-s3": {
        "task": "tasks.archive.move_to_cold_storage",
        "schedule": crontab(hour=2, minute=0, day_of_month=1),
    },
}
```

**[ ] 10.4 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### Phase 10 ì™„ë£Œ ì²´í¬

```bash
git add .
git commit -m "Phase 10 ì™„ë£Œ: ì„±ëŠ¥ ìµœì í™”

- Binary WebSocket í”„ë¡œí† ì½œ (MessagePack, 50-70% í¬ê¸° ê°ì†Œ)
- Async Job Queue (Celery + Redis)
- í•¸ë“œ íˆìŠ¤í† ë¦¬ ì••ì¶• ì €ì¥ (80% ë¹„ìš© ì ˆê°)
- Celery Beat ìŠ¤ì¼€ì¤„ëŸ¬"
```

**[ ] Phase 10 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

## Phase 11: ì˜¤í”ˆì†ŒìŠ¤ í†µí•© (v1.3 ì¶”ê°€)

> **ì˜ˆìƒ ê¸°ê°„**: 4-6ì¼
> **ìš°ì„ ìˆœìœ„**: â­â­â­â­ (ê¶Œì¥)
> **í˜„ì¬ ìƒíƒœ**: â³ ëŒ€ê¸°
> **ëª©í‘œ**: í”„ë¡œë•ì…˜ ì•ˆì •ì„±, ê´€ì¸¡ì„±, ì„±ëŠ¥ í–¥ìƒ

### 11.1 ì¶”ì²œ ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

#### ì„ ì •ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | GitHub Stars | ìš©ë„ | íš¨ê³¼ |
|-----------|-------------|------|------|
| **orjson** | 5.8k+ | ë¹ ë¥¸ JSON ì§ë ¬í™” | 3-10ë°° ì„±ëŠ¥ í–¥ìƒ |
| **structlog** | 3.2k+ | êµ¬ì¡°í™”ëœ ë¡œê¹… | ë””ë²„ê¹…/ëª¨ë‹ˆí„°ë§ ìš©ì´ |
| **httpx** | 12k+ | ë¹„ë™ê¸° HTTP í´ë¼ì´ì–¸íŠ¸ | ì•”í˜¸í™”í API í˜¸ì¶œ |
| **tenacity** | 6k+ | ì¬ì‹œë„ ë¡œì§ | ì™¸ë¶€ API ì•ˆì •ì„± |
| **slowapi** | 1.1k+ | Rate Limiting | DDoS/ì•…ìš© ë°©ì§€ |
| **sentry-sdk** | 1.8k+ | ì—ëŸ¬ ì¶”ì  | í”„ë¡œë•ì…˜ ëª¨ë‹ˆí„°ë§ |

```bash
# ì„¤ì¹˜
pip install orjson structlog httpx tenacity slowapi sentry-sdk
```

**[ ] 11.1 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 11.2 orjson - ê³ ì† JSON ì§ë ¬í™”

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

#### 11.2.1 orjson ì ìš©
- [ ] ê¸°ì¡´ `json` ëª¨ë“ˆì„ `orjson`ìœ¼ë¡œ êµì²´
- [ ] Pydantic ëª¨ë¸ ì§ë ¬í™” ìµœì í™”

```python
# backend/app/utils/json_utils.py
import orjson
from typing import Any

def json_dumps(data: Any) -> str:
    """orjson ì§ë ¬í™” (ê¸°ë³¸ json ëŒ€ë¹„ 3-10ë°° ë¹ ë¦„)"""
    return orjson.dumps(data).decode("utf-8")

def json_loads(data: str | bytes) -> Any:
    """orjson ì—­ì§ë ¬í™”"""
    return orjson.loads(data)

# FastAPI ì‘ë‹µì— ì ìš©
from fastapi.responses import ORJSONResponse

app = FastAPI(default_response_class=ORJSONResponse)
```

#### 11.2.2 ì„±ëŠ¥ ë¹„êµ

| ì‘ì—… | json | orjson | í–¥ìƒ |
|------|------|--------|------|
| ì§ë ¬í™” (TABLE_SNAPSHOT) | 2.1ms | 0.3ms | 7x |
| ì—­ì§ë ¬í™” (ACTION) | 0.8ms | 0.12ms | 6.7x |

**[ ] 11.2 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 11.3 structlog - êµ¬ì¡°í™”ëœ ë¡œê¹…

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

#### 11.3.1 ë¡œê¹… ì„¤ì •
- [ ] `backend/app/logging_config.py` ìƒì„±
- [ ] JSON êµ¬ì¡°í™” ë¡œê·¸ ì¶œë ¥

```python
# backend/app/logging_config.py
import structlog

structlog.configure(
    processors=[
        structlog.contextvars.merge_contextvars,
        structlog.processors.add_log_level,
        structlog.processors.TimeStamper(fmt="iso"),
        structlog.processors.StackInfoRenderer(),
        structlog.processors.format_exc_info,
        structlog.processors.JSONRenderer(),
    ],
    wrapper_class=structlog.make_filtering_bound_logger(logging.INFO),
    context_class=dict,
    logger_factory=structlog.PrintLoggerFactory(),
    cache_logger_on_first_use=True,
)

# ì‚¬ìš© ì˜ˆì‹œ
logger = structlog.get_logger()

async def handle_action(table_id: str, user_id: str, action: str):
    logger.info(
        "player_action",
        table_id=table_id,
        user_id=user_id,
        action=action,
        timestamp=datetime.utcnow().isoformat()
    )
```

#### 11.3.2 ì»¨í…ìŠ¤íŠ¸ ë¡œê¹…
- [ ] ìš”ì²­ë³„ trace_id ìë™ ì¶”ê°€
- [ ] ì‚¬ìš©ì/í…Œì´ë¸” ì»¨í…ìŠ¤íŠ¸ ë°”ì¸ë”©

```python
# ë¯¸ë“¤ì›¨ì–´ì—ì„œ ì»¨í…ìŠ¤íŠ¸ ì„¤ì •
@app.middleware("http")
async def logging_middleware(request: Request, call_next):
    structlog.contextvars.clear_contextvars()
    structlog.contextvars.bind_contextvars(
        trace_id=str(uuid4()),
        path=request.url.path,
    )
    response = await call_next(request)
    return response
```

**[ ] 11.3 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 11.4 httpx + tenacity - ì™¸ë¶€ API ì•ˆì •ì„±

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

#### 11.4.1 ë¹„ë™ê¸° HTTP í´ë¼ì´ì–¸íŠ¸
- [ ] `backend/app/utils/http_client.py` ìƒì„±
- [ ] ì•”í˜¸í™”í í™˜ìœ¨ API í˜¸ì¶œì— ì ìš©

```python
# backend/app/utils/http_client.py
import httpx
from tenacity import retry, stop_after_attempt, wait_exponential

class AsyncHttpClient:
    """ì¬ì‹œë„ ë¡œì§ì´ í¬í•¨ëœ ë¹„ë™ê¸° HTTP í´ë¼ì´ì–¸íŠ¸"""

    def __init__(self):
        self._client = httpx.AsyncClient(
            timeout=httpx.Timeout(10.0, connect=5.0),
            limits=httpx.Limits(max_connections=100)
        )

    @retry(
        stop=stop_after_attempt(3),
        wait=wait_exponential(multiplier=1, min=1, max=10)
    )
    async def get_json(self, url: str) -> dict:
        """GET ìš”ì²­ + JSON íŒŒì‹± (ìµœëŒ€ 3íšŒ ì¬ì‹œë„)"""
        response = await self._client.get(url)
        response.raise_for_status()
        return response.json()

    async def close(self):
        await self._client.aclose()
```

#### 11.4.2 í™˜ìœ¨ API ì ìš©
- [ ] CoinGecko/Binance API í˜¸ì¶œì— ì ìš©
- [ ] ì¬ì‹œë„ + í´ë°± ë¡œì§

```python
# backend/app/services/exchange_rate.py
class ExchangeRateService:
    def __init__(self, http_client: AsyncHttpClient):
        self._http = http_client

    @retry(stop=stop_after_attempt(3), wait=wait_exponential())
    async def get_btc_krw_rate(self) -> int:
        """BTC/KRW í™˜ìœ¨ ì¡°íšŒ (ì¬ì‹œë„ í¬í•¨)"""
        try:
            # ê¸°ë³¸: CoinGecko
            data = await self._http.get_json(
                "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=krw"
            )
            return data["bitcoin"]["krw"]
        except Exception:
            # í´ë°±: Binance
            data = await self._http.get_json(
                "https://api.binance.com/api/v3/ticker/price?symbol=BTCKRW"
            )
            return int(float(data["price"]))
```

**[ ] 11.4 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 11.5 slowapi - Rate Limiting ê°•í™”

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

#### 11.5.1 Rate Limiter ì„¤ì •
- [ ] `backend/app/middleware/rate_limit.py` ìƒì„±
- [ ] ì—”ë“œí¬ì¸íŠ¸ë³„ ì œí•œ ì„¤ì •

```python
# backend/app/middleware/rate_limit.py
from slowapi import Limiter, _rate_limit_exceeded_handler
from slowapi.util import get_remote_address
from slowapi.errors import RateLimitExceeded

limiter = Limiter(
    key_func=get_remote_address,
    default_limits=["100/minute"],
    storage_uri="redis://localhost:6379/3"  # Redis ê¸°ë°˜ ë¶„ì‚° Rate Limiting
)

# main.pyì— ì ìš©
app.state.limiter = limiter
app.add_exception_handler(RateLimitExceeded, _rate_limit_exceeded_handler)
```

#### 11.5.2 ì—”ë“œí¬ì¸íŠ¸ë³„ ì œí•œ

```python
# backend/app/api/auth.py
from app.middleware.rate_limit import limiter

@router.post("/login")
@limiter.limit("5/minute")  # ë¡œê·¸ì¸: ë¶„ë‹¹ 5íšŒ
async def login(request: Request, ...):
    pass

@router.post("/register")
@limiter.limit("3/minute")  # íšŒì›ê°€ì…: ë¶„ë‹¹ 3íšŒ
async def register(request: Request, ...):
    pass

# backend/app/api/wallet.py
@router.post("/withdraw")
@limiter.limit("10/hour")  # ì¶œê¸ˆ: ì‹œê°„ë‹¹ 10íšŒ
async def withdraw(request: Request, ...):
    pass
```

**[ ] 11.5 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 11.6 sentry-sdk - í”„ë¡œë•ì…˜ ì—ëŸ¬ ì¶”ì 

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ

#### 11.6.1 Sentry ì„¤ì •
- [ ] Sentry í”„ë¡œì íŠ¸ ìƒì„±
- [ ] SDK ì´ˆê¸°í™”

```python
# backend/app/main.py
import sentry_sdk
from sentry_sdk.integrations.fastapi import FastApiIntegration
from sentry_sdk.integrations.sqlalchemy import SqlalchemyIntegration
from sentry_sdk.integrations.redis import RedisIntegration

sentry_sdk.init(
    dsn=settings.sentry_dsn,
    environment=settings.environment,  # "production", "staging"
    integrations=[
        FastApiIntegration(transaction_style="endpoint"),
        SqlalchemyIntegration(),
        RedisIntegration(),
    ],
    traces_sample_rate=0.1,  # 10% íŠ¸ëœì­ì…˜ ìƒ˜í”Œë§
    profiles_sample_rate=0.1,  # 10% í”„ë¡œíŒŒì¼ë§
    send_default_pii=False,  # ê°œì¸ì •ë³´ ì „ì†¡ ì•ˆí•¨
)
```

#### 11.6.2 ì»¤ìŠ¤í…€ ì»¨í…ìŠ¤íŠ¸
- [ ] ì‚¬ìš©ì/í…Œì´ë¸” ì •ë³´ ì²¨ë¶€
- [ ] ê¸ˆìœµ ê±°ë˜ ì—ëŸ¬ ìš°ì„  ì•Œë¦¼

```python
# ì—ëŸ¬ ë°œìƒ ì‹œ ì»¨í…ìŠ¤íŠ¸ ì²¨ë¶€
import sentry_sdk

async def process_withdrawal(user_id: str, amount: int):
    with sentry_sdk.push_scope() as scope:
        scope.set_user({"id": user_id})
        scope.set_tag("transaction_type", "withdrawal")
        scope.set_extra("amount_krw", amount)

        try:
            # ì¶œê¸ˆ ì²˜ë¦¬
            pass
        except Exception as e:
            scope.set_level("fatal")  # ê¸ˆìœµ ê±°ë˜ëŠ” fatal
            sentry_sdk.capture_exception(e)
            raise
```

**[ ] 11.6 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### 11.7 ì¶”ê°€ ê²€í†  ì˜¤í”ˆì†ŒìŠ¤ (ì„ íƒ)

**ìƒíƒœ**: [ ] ë¯¸ì™„ë£Œ (ì„ íƒì‚¬í•­)

#### ê³ ë ¤í•  ë§Œí•œ ì¶”ê°€ ë¼ì´ë¸ŒëŸ¬ë¦¬

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ìš©ë„ | ë„ì… ì‹œì  |
|-----------|------|----------|
| **locust** | Python ë¶€í•˜ í…ŒìŠ¤íŠ¸ | Phase 7ì—ì„œ k6 ëŒ€ì²´ ê°€ëŠ¥ |
| **faker** | í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± | í…ŒìŠ¤íŠ¸ ì‘ì„± ì‹œ |
| **aiocache** | ë¹„ë™ê¸° ìºì‹± ì¶”ìƒí™” | Phase 4 ë³´ê°• ì‹œ |
| **python-arq** | ê²½ëŸ‰ ì‘ì—… í | Celery ëŒ€ì•ˆ ê²€í†  ì‹œ |
| **pydantic-settings** | ì„¤ì • ê´€ë¦¬ | ì´ë¯¸ Pydantic v2 í¬í•¨ |

#### Hugging Face ê²€í†  ê²°ê³¼
- í¬ì»¤ íŠ¹í™” ML ëª¨ë¸: í˜„ì¬ ì—†ìŒ
- ì´ìƒ íƒì§€ ëª¨ë¸: ìš´ì˜ ë°ì´í„° ì¶•ì  í›„ ìì²´ í•™ìŠµ ê¶Œì¥
- **ê²°ë¡ **: 300-500ëª… ê·œëª¨ì—ì„œëŠ” MLë³´ë‹¤ ê¸°ë³¸ íŒ¨í„´ ê°ì§€ê°€ íš¨ê³¼ì 

**[ ] 11.7 ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

### Phase 11 ì™„ë£Œ ì²´í¬

```bash
git add .
git commit -m "Phase 11 ì™„ë£Œ: ì˜¤í”ˆì†ŒìŠ¤ í†µí•©

- orjson: JSON ì§ë ¬í™” 3-10ë°° í–¥ìƒ
- structlog: êµ¬ì¡°í™”ëœ ë¡œê¹…
- httpx + tenacity: ì™¸ë¶€ API ì•ˆì •ì„±
- slowapi: Rate Limiting ê°•í™”
- sentry-sdk: í”„ë¡œë•ì…˜ ì—ëŸ¬ ì¶”ì "
```

**[ ] Phase 11 ì „ì²´ ì™„ë£Œ** - ë‚ ì§œ/ì‹œê°„: _______________

---

## ë§ˆì¼ìŠ¤í†¤ ìš”ì•½

| Phase | ì‘ì—… ë‚´ìš© | í•µì‹¬ ê²€ì¦ í•­ëª© | ìƒíƒœ |
|-------|---------|--------------|------|
| 1 | ì»¤ë„¥ì…˜ í’€ & ì¸í”„ë¼ | DB 50+30, Redis 100 | âœ… |
| 2 | WebSocket í´ëŸ¬ìŠ¤í„°ë§ (ê°•í™”) | Redis Pub/Sub + Sticky Session | âœ… |
| 3 | DB ìµœì í™” | Slow query 0ê±´ | âœ… |
| 4 | Redis ê³ ê°€ìš©ì„± + ê²Œì„ ìºì‹± | DB ë¶€í•˜ 70-90% ê°ì†Œ | âœ… |
| 5 | KRW + ì•”í˜¸í™”í ì…ì¶œê¸ˆ | ì…ì¶œê¸ˆ ì •ìƒ ì‘ë™ | âœ… |
| 6 | Rake ì‹œìŠ¤í…œ | Rake ê³„ì‚° 100% ì •í™• | [ ] |
| 7 | ë¶€í•˜ í…ŒìŠ¤íŠ¸ | 500ëª… p95 < 200ms | [ ] |
| 8 | ëª¨ë‹ˆí„°ë§ | ëŒ€ì‹œë³´ë“œ ìš´ì˜ | [ ] |
| 9 | ìš´ì˜ ì•ˆì •í™” | ë³µêµ¬ í…ŒìŠ¤íŠ¸ í†µê³¼ | [ ] |
| 10 | ì„±ëŠ¥ ìµœì í™” | MessagePack 50%â†“, Celery ì‘ë™ | [ ] |
| 11 | ì˜¤í”ˆì†ŒìŠ¤ í†µí•© (v1.3) | ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ í†µí•© í…ŒìŠ¤íŠ¸ | [ ] |

---

## ì„¸ì…˜ ì¬ê°œ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ”„ ì„¸ì…˜ ì¬ê°œ ì‹œ í™•ì¸ì‚¬í•­                                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘  1. [ ] ë§ˆì§€ë§‰ [x] ì²´í¬ëœ ë‹¨ê³„ í™•ì¸                                    â•‘
â•‘  2. [ ] git statusë¡œ uncommitted ë³€ê²½ì‚¬í•­ í™•ì¸                         â•‘
â•‘  3. [ ] í•„ìš”ì‹œ git stash ë˜ëŠ” commit                                   â•‘
â•‘  4. [ ] ì¤‘ë‹¨ëœ ì‘ì—…ë¶€í„° ì´ì–´ì„œ ì§„í–‰                                     â•‘
â•‘  5. [ ] ì‘ì—… ì™„ë£Œ ì¦‰ì‹œ [ ] â†’ [x] ì²´í¬                                  â•‘
â•‘                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ì‘ì—… ë¡œê·¸

| ë‚ ì§œ | Phase | ì‘ì—… ë‚´ìš© | ì‘ì—…ì |
|------|-------|-----------|--------|
| 2026-01-12 | - | ë°±ì—”ë“œ ìŠ¤ì¼€ì¼ë§ ì‘ì—…ê³„íšì„œ v1.0 ì‘ì„± | Claude |
| 2026-01-12 | - | v1.1: KRW + ì•”í˜¸í™”í ì…ì¶œê¸ˆ ë°˜ì˜, ì™„ë£Œ ì²´í¬ ì§€ì¹¨ ê°•í™” | Claude |
| 2026-01-12 | - | v1.2: ì„±ëŠ¥ ìµœì í™” í•­ëª© ì¶”ê°€ (MessagePack, Celery, ì••ì¶•) | Claude |
| 2026-01-12 | - | v1.3 Final: ì˜¤í”ˆì†ŒìŠ¤ í†µí•© (orjson, structlog, httpx, sentry) | Claude |
| | | | |

---

> **ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2026-01-12
> **ë²„ì „**: 1.3 Final
> **ë‹¤ìŒ ì‘ì—…**: Phase 1.1 PostgreSQL ì»¤ë„¥ì…˜ í’€ í™•ì¥
